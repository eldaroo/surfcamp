"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/availability/route";
exports.ids = ["app/api/availability/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var C_Users_loko_OneDrive_Desktop_Escritorio_surfcamp_app_api_availability_route_ts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./app/api/availability/route.ts */ \"(rsc)/./app/api/availability/route.ts\");\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/availability/route\",\n        pathname: \"/api/availability\",\n        filename: \"route\",\n        bundlePath: \"app/api/availability/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\loko_\\\\OneDrive\\\\Desktop\\\\Escritorio\\\\surfcamp\\\\app\\\\api\\\\availability\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_loko_OneDrive_Desktop_Escritorio_surfcamp_app_api_availability_route_ts__WEBPACK_IMPORTED_MODULE_2__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/availability/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdmFpbGFiaWxpdHklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF2YWlsYWJpbGl0eSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF2YWlsYWJpbGl0eSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNsb2tvXyU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q0VzY3JpdG9yaW8lNUNzdXJmY2FtcCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDbG9rb18lNUNPbmVEcml2ZSU1Q0Rlc2t0b3AlNUNFc2NyaXRvcmlvJTVDc3VyZmNhbXAmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ3lEO0FBQ3hIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ2lKOztBQUVqSiIsInNvdXJjZXMiOlsid2VicGFjazovL3N1cmZjYW1wLWJvb2tpbmctc3lzdGVtLz82ZTYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGxva29fXFxcXE9uZURyaXZlXFxcXERlc2t0b3BcXFxcRXNjcml0b3Jpb1xcXFxzdXJmY2FtcFxcXFxhcHBcXFxcYXBpXFxcXGF2YWlsYWJpbGl0eVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXZhaWxhYmlsaXR5L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXZhaWxhYmlsaXR5XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hdmFpbGFiaWxpdHkvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxsb2tvX1xcXFxPbmVEcml2ZVxcXFxEZXNrdG9wXFxcXEVzY3JpdG9yaW9cXFxcc3VyZmNhbXBcXFxcYXBwXFxcXGFwaVxcXFxhdmFpbGFiaWxpdHlcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXZhaWxhYmlsaXR5L3JvdXRlXCI7XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/availability/route.ts":
/*!***************************************!*\
  !*** ./app/api/availability/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_lobbypms__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/lobbypms */ \"(rsc)/./lib/lobbypms.ts\");\n\n\nconst sentWhatsAppSet = new Set();\nasync function POST(request) {\n    try {\n        console.log(\"\\uD83C\\uDFAF Availability API called - START\");\n        const body = await request.json();\n        const { checkIn, checkOut, guests } = body;\n        console.log(\"\\uD83C\\uDFAF Availability API called with:\", {\n            checkIn,\n            checkOut,\n            guests\n        });\n        try {\n            console.log(\"\\uD83D\\uDE80 Calling LobbyPMS API with CORRECT endpoint...\");\n            // Use the correct endpoint: /available-rooms\n            const availabilityData = await _lib_lobbypms__WEBPACK_IMPORTED_MODULE_1__.lobbyPMSClient.getAvailableRooms({\n                start_date: checkIn,\n                end_date: checkOut\n            });\n            console.log(\"\\uD83D\\uDCCB ===== AVAILABILITY DATA RECEIVED =====\");\n            console.log(\"\\uD83D\\uDCCB Total days received:\", availabilityData.length);\n            console.log(\"\\uD83D\\uDCCB Raw availability data:\", JSON.stringify(availabilityData, null, 2));\n            // Process the availability data to extract rooms and prices\n            const roomTypes = {\n                \"casa-playa\": {\n                    roomTypeId: \"casa-playa\",\n                    roomTypeName: \"Casa de Playa (Cuarto Compartido)\",\n                    maxGuests: 8,\n                    categories: [],\n                    availableRoomsByDay: [],\n                    prices: []\n                },\n                \"casitas-privadas\": {\n                    roomTypeId: \"casitas-privadas\",\n                    roomTypeName: \"Casitas Privadas\",\n                    maxGuests: 2,\n                    categories: [],\n                    availableRoomsByDay: [],\n                    prices: []\n                },\n                \"casas-deluxe\": {\n                    roomTypeId: \"casas-deluxe\",\n                    roomTypeName: \"Casas Deluxe\",\n                    maxGuests: 2,\n                    categories: [],\n                    availableRoomsByDay: [],\n                    prices: []\n                }\n            };\n            // Calculate number of nights (not days)\n            // For check-in 17/7 and check-out 18/7, we only need to verify night of 17/7\n            const checkInDate = new Date(checkIn);\n            const checkOutDate = new Date(checkOut);\n            const nights = Math.ceil((checkOutDate.getTime() - checkInDate.getTime()) / (1000 * 60 * 60 * 24));\n            console.log(`📅 Check-in: ${checkIn}, Check-out: ${checkOut}`);\n            console.log(`📅 Nights needed: ${nights}`);\n            console.log(`📅 Will only process first ${nights} days for availability`);\n            // Track individual categories for proper availability calculation\n            const individualCategories = {};\n            // Only process the days we need (number of nights)\n            const daysToProcess = Math.min(nights, availabilityData.length);\n            availabilityData.slice(0, daysToProcess).forEach((dayData, dayIndex)=>{\n                console.log(`📅 Processing day ${dayIndex + 1}: ${dayData.date}`);\n                if (dayData.categories && Array.isArray(dayData.categories)) {\n                    dayData.categories.forEach((category, catIndex)=>{\n                        console.log(`🏠 ===== PROCESSING CATEGORY ${catIndex + 1} =====`);\n                        console.log(`🏠 Category ID: ${category.category_id}`);\n                        console.log(`🏠 Category name: \"${category.name}\"`);\n                        console.log(`🏠 Available rooms: ${category.available_rooms}`);\n                        console.log(`🏠 Prices:`, category.prices);\n                        // Map categories to our 3 accommodation types\n                        const categoryName = (category.name || \"\").toLowerCase();\n                        const singlePrice = category.prices?.find((p)=>p.people === 1)?.value;\n                        // Initialize category tracking if not exists\n                        if (!individualCategories[categoryName]) {\n                            individualCategories[categoryName] = {\n                                availableByDay: new Array(nights).fill(0),\n                                prices: [],\n                                roomType: \"\"\n                            };\n                        }\n                        // Set availability for this day\n                        individualCategories[categoryName].availableByDay[dayIndex] = category.available_rooms || 0;\n                        // 1. CASA DE PLAYA: SOLO \"Casa Playa\" (las 8 camas dentro de Casa Playa)\n                        if (categoryName === \"casa playa\") {\n                            console.log(\"✅ Matched as Casa de Playa (Cuarto Compartido)\");\n                            roomTypes[\"casa-playa\"].categories.push(category);\n                            individualCategories[categoryName].roomType = \"casa-playa\";\n                            // Solo agregar precio si hay disponibilidad\n                            if (singlePrice && singlePrice > 0 && (category.available_rooms || 0) > 0) {\n                                roomTypes[\"casa-playa\"].prices.push(singlePrice);\n                                individualCategories[categoryName].prices.push(singlePrice);\n                            }\n                        } else if (categoryName === \"casita 3\" || categoryName === \"casita 4\" || categoryName === \"casita 7\") {\n                            console.log(\"✅ Matched as Casita Privada\");\n                            roomTypes[\"casitas-privadas\"].categories.push(category);\n                            individualCategories[categoryName].roomType = \"casitas-privadas\";\n                            // Solo agregar precio si hay disponibilidad\n                            if (singlePrice && singlePrice > 0 && (category.available_rooms || 0) > 0) {\n                                roomTypes[\"casitas-privadas\"].prices.push(singlePrice);\n                                individualCategories[categoryName].prices.push(singlePrice);\n                            }\n                        } else if (categoryName === \"studio 1\" || categoryName === \"studio 2\" || categoryName === \"casita 5\" || categoryName === \"casita 6\") {\n                            console.log(\"✅ Matched as Casa Deluxe\");\n                            roomTypes[\"casas-deluxe\"].categories.push(category);\n                            individualCategories[categoryName].roomType = \"casas-deluxe\";\n                            // Solo agregar precio si hay disponibilidad\n                            if (singlePrice && singlePrice > 0 && (category.available_rooms || 0) > 0) {\n                                roomTypes[\"casas-deluxe\"].prices.push(singlePrice);\n                                individualCategories[categoryName].prices.push(singlePrice);\n                            }\n                        } else {\n                            console.log(`❌ CATEGORY NOT INCLUDED: \"${category.name}\"`);\n                            console.log(`❌ This category is not part of the valid accommodation types`);\n                            console.log(`❌ Only these categories are valid:`);\n                            console.log(`   - Casa de Playa: \"Casa Playa\"`);\n                            console.log(`   - Casitas Privadas: \"Casita 3\", \"Casita 4\", \"Casita 7\"`);\n                            console.log(`   - Casas Deluxe: \"Studio 1\", \"Studio 2\", \"Casita 5\", \"Casita 6\"`);\n                        // Continue processing but don't include this category\n                        }\n                    });\n                }\n            });\n            // Calculate total availability for each room type using correct logic\n            Object.keys(roomTypes).forEach((roomTypeKey)=>{\n                const roomType = roomTypes[roomTypeKey];\n                let totalAvailableForAllDays = 0;\n                // Find all categories that belong to this room type\n                Object.entries(individualCategories).forEach(([categoryName, categoryData])=>{\n                    if (categoryData.roomType === roomTypeKey) {\n                        // For each individual category, calculate minimum available across all days\n                        const minAvailableForCategory = categoryData.availableByDay.length > 0 ? Math.min(...categoryData.availableByDay) : 0;\n                        console.log(`🏠 Category \"${categoryName}\" - Days: [${categoryData.availableByDay.join(\", \")}] - Min: ${minAvailableForCategory}`);\n                        // Add this category's minimum to the total\n                        totalAvailableForAllDays += minAvailableForCategory;\n                    }\n                });\n                // Set the calculated availability\n                roomType.availableRoomsByDay = [\n                    totalAvailableForAllDays\n                ]; // Single value representing total available\n                console.log(`🎯 ${roomTypeKey} - Total available for all days: ${totalAvailableForAllDays}`);\n            });\n            // Convert grouped data to final format\n            const availableRooms = [];\n            // ALWAYS return all 3 accommodation types, even if not available\n            Object.entries(roomTypes).forEach(([key, roomType])=>{\n                // Calculate representative price (median or most common)\n                let finalPrice = null;\n                if (roomType.prices.length > 0) {\n                    // Use the special price for \"Casa Playa\" if it exists\n                    if (key === \"casa-playa\") {\n                        const casaPlayaPrice = roomType.prices.find((p)=>p === 20);\n                        if (casaPlayaPrice) {\n                            finalPrice = casaPlayaPrice;\n                        } else {\n                            // Use median price\n                            const sortedPrices = roomType.prices.sort((a, b)=>a - b);\n                            finalPrice = sortedPrices[Math.floor(sortedPrices.length / 2)];\n                        }\n                    } else {\n                        // Use median price for other types\n                        const sortedPrices = roomType.prices.sort((a, b)=>a - b);\n                        finalPrice = sortedPrices[Math.floor(sortedPrices.length / 2)];\n                    }\n                }\n                // Add room type regardless of availability\n                const totalAvailable = roomType.availableRoomsByDay.length > 0 ? roomType.availableRoomsByDay[0] : 0;\n                availableRooms.push({\n                    roomTypeId: roomType.roomTypeId,\n                    roomTypeName: roomType.roomTypeName,\n                    pricePerNight: finalPrice,\n                    realPrice: finalPrice,\n                    priceSource: finalPrice ? \"LOBBYPMS_AVAILABLE_ROOMS_API\" : null,\n                    maxGuests: roomType.maxGuests,\n                    availableRooms: totalAvailable,\n                    available: totalAvailable > 0,\n                    debug: {\n                        originalCategory: roomType.categories[0] || null,\n                        source: \"available-rooms-endpoint\",\n                        allCategories: roomType.categories.map((c)=>c.name),\n                        allPrices: roomType.prices,\n                        availableRoomsByDay: roomType.availableRoomsByDay,\n                        minAvailableRooms: totalAvailable\n                    }\n                });\n            });\n            console.log(\"\\uD83C\\uDFAF ===== FINAL RESULT WITH REAL PRICES =====\");\n            console.log(\"\\uD83C\\uDFAF Available rooms:\", availableRooms.length);\n            availableRooms.forEach((room, index)=>{\n                console.log(`🏠 ${index + 1}. ${room.roomTypeName}:`);\n                console.log(`   💰 Real Price: $${room.realPrice} (${room.priceSource || \"NO_PRICE\"})`);\n                console.log(`   🛏️ Available: ${room.availableRooms} (min across days)`);\n                console.log(`   📅 By day: [${room.debug.availableRoomsByDay.join(\", \")}]`);\n                console.log(`   📊 All prices: [${room.debug.allPrices.join(\", \")}]`);\n                console.log(`   🏷️ Categories: [${room.debug.allCategories.join(\", \")}]`);\n            });\n            if (availableRooms.length === 0) {\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    success: false,\n                    error: \"No rooms available for the selected dates\",\n                    debug: {\n                        totalDaysProcessed: availabilityData.length,\n                        availabilityData: availabilityData,\n                        message: \"No matching room categories found\"\n                    }\n                }, {\n                    status: 404\n                });\n            }\n            const result = {\n                success: true,\n                available: true,\n                maxGuests: 12,\n                availableRooms: availableRooms,\n                debug: {\n                    totalDaysFromAPI: availabilityData.length,\n                    endpointUsed: \"/available-rooms\",\n                    priceAnalysis: availableRooms.map((r)=>({\n                            room: r.roomTypeName,\n                            price: r.pricePerNight,\n                            realPrice: r.realPrice,\n                            source: r.priceSource\n                        }))\n                }\n            };\n            // Eliminar toda la lógica de envío de WhatsApp aquí\n            // Solo devolver la respuesta normalmente\n            console.log(\"\\uD83D\\uDCE4 Returning result with REAL prices from correct endpoint:\", JSON.stringify(result, null, 2));\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(result);\n        } catch (apiError) {\n            console.error(\"❌ LobbyPMS API error:\", apiError.message);\n            console.error(\"❌ Full error details:\", {\n                message: apiError.message,\n                name: apiError.name,\n                stack: apiError.stack,\n                response: apiError.response?.data\n            });\n            // Determine if this is an HTML response error\n            const isHtmlError = apiError.message && apiError.message.includes(\"HTML\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: isHtmlError ? \"LobbyPMS API est\\xe1 devolviendo HTML en lugar de JSON - posible problema de IP o autenticaci\\xf3n\" : \"Error de conexi\\xf3n con LobbyPMS\",\n                debug: {\n                    errorType: apiError.name,\n                    message: apiError.message,\n                    suggestion: isHtmlError ? \"Verifica que tu IP est\\xe1 autorizada en LobbyPMS y que el API token es v\\xe1lido\" : \"Endpoint /available-rooms failed - check API credentials and IP authorization\",\n                    endpointUsed: \"/available-rooms\",\n                    isHtmlError: isHtmlError,\n                    timestamp: new Date().toISOString()\n                }\n            }, {\n                status: 503\n            });\n        }\n    } catch (error) {\n        console.error(\"❌ General availability error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error checking availability\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F2YWlsYWJpbGl0eS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBd0Q7QUFFUjtBQUdoRCxNQUFNRSxrQkFBa0IsSUFBSUM7QUFFckIsZUFBZUMsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFFWixNQUFNQyxPQUFPLE1BQU1ILFFBQVFJLElBQUk7UUFDL0IsTUFBTSxFQUFFQyxPQUFPLEVBQUVDLFFBQVEsRUFBRUMsTUFBTSxFQUFFLEdBQUdKO1FBRXRDRixRQUFRQyxHQUFHLENBQUMsOENBQW9DO1lBQUVHO1lBQVNDO1lBQVVDO1FBQU87UUFFNUUsSUFBSTtZQUNGTixRQUFRQyxHQUFHLENBQUM7WUFFWiw2Q0FBNkM7WUFDN0MsTUFBTU0sbUJBQW1CLE1BQU1aLHlEQUFjQSxDQUFDYSxpQkFBaUIsQ0FBQztnQkFDOURDLFlBQVlMO2dCQUNaTSxVQUFVTDtZQUVaO1lBRUFMLFFBQVFDLEdBQUcsQ0FBQztZQUNaRCxRQUFRQyxHQUFHLENBQUMscUNBQTJCTSxpQkFBaUJJLE1BQU07WUFDOURYLFFBQVFDLEdBQUcsQ0FBQyx1Q0FBNkJXLEtBQUtDLFNBQVMsQ0FBQ04sa0JBQWtCLE1BQU07WUFFaEYsNERBQTREO1lBQzVELE1BQU1PLFlBQVk7Z0JBQ2hCLGNBQWM7b0JBQ1pDLFlBQVk7b0JBQ1pDLGNBQWM7b0JBQ2RDLFdBQVc7b0JBQ1hDLFlBQVksRUFBRTtvQkFDZEMscUJBQXFCLEVBQUU7b0JBQ3ZCQyxRQUFRLEVBQUU7Z0JBQ1o7Z0JBQ0Esb0JBQW9CO29CQUNsQkwsWUFBWTtvQkFDWkMsY0FBYztvQkFDZEMsV0FBVztvQkFDWEMsWUFBWSxFQUFFO29CQUNkQyxxQkFBcUIsRUFBRTtvQkFDdkJDLFFBQVEsRUFBRTtnQkFDWjtnQkFDQSxnQkFBZ0I7b0JBQ2RMLFlBQVk7b0JBQ1pDLGNBQWM7b0JBQ2RDLFdBQVc7b0JBQ1hDLFlBQVksRUFBRTtvQkFDZEMscUJBQXFCLEVBQUU7b0JBQ3ZCQyxRQUFRLEVBQUU7Z0JBQ1o7WUFDRjtZQUVBLHdDQUF3QztZQUN4Qyw2RUFBNkU7WUFDN0UsTUFBTUMsY0FBYyxJQUFJQyxLQUFLbEI7WUFDN0IsTUFBTW1CLGVBQWUsSUFBSUQsS0FBS2pCO1lBQzlCLE1BQU1tQixTQUFTQyxLQUFLQyxJQUFJLENBQUMsQ0FBQ0gsYUFBYUksT0FBTyxLQUFLTixZQUFZTSxPQUFPLEVBQUMsSUFBTSxRQUFPLEtBQUssS0FBSyxFQUFDO1lBRS9GM0IsUUFBUUMsR0FBRyxDQUFDLENBQUMsYUFBYSxFQUFFRyxRQUFRLGFBQWEsRUFBRUMsU0FBUyxDQUFDO1lBQzdETCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxrQkFBa0IsRUFBRXVCLE9BQU8sQ0FBQztZQUN6Q3hCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDJCQUEyQixFQUFFdUIsT0FBTyxzQkFBc0IsQ0FBQztZQUV4RSxrRUFBa0U7WUFDbEUsTUFBTUksdUJBQTRHLENBQUM7WUFFbkgsbURBQW1EO1lBQ25ELE1BQU1DLGdCQUFnQkosS0FBS0ssR0FBRyxDQUFDTixRQUFRakIsaUJBQWlCSSxNQUFNO1lBQzlESixpQkFBaUJ3QixLQUFLLENBQUMsR0FBR0YsZUFBZUcsT0FBTyxDQUFDLENBQUNDLFNBQVNDO2dCQUN6RGxDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFaUMsV0FBVyxFQUFFLEVBQUUsRUFBRUQsUUFBUUUsSUFBSSxDQUFDLENBQUM7Z0JBRWhFLElBQUlGLFFBQVFmLFVBQVUsSUFBSWtCLE1BQU1DLE9BQU8sQ0FBQ0osUUFBUWYsVUFBVSxHQUFHO29CQUMzRGUsUUFBUWYsVUFBVSxDQUFDYyxPQUFPLENBQUMsQ0FBQ00sVUFBZUM7d0JBQ3pDdkMsUUFBUUMsR0FBRyxDQUFDLENBQUMsNkJBQTZCLEVBQUVzQyxXQUFXLEVBQUUsTUFBTSxDQUFDO3dCQUNoRXZDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGdCQUFnQixFQUFFcUMsU0FBU0UsV0FBVyxDQUFDLENBQUM7d0JBQ3JEeEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsbUJBQW1CLEVBQUVxQyxTQUFTRyxJQUFJLENBQUMsQ0FBQyxDQUFDO3dCQUNsRHpDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixFQUFFcUMsU0FBU0ksZUFBZSxDQUFDLENBQUM7d0JBQzdEMUMsUUFBUUMsR0FBRyxDQUFDLENBQUMsVUFBVSxDQUFDLEVBQUVxQyxTQUFTbEIsTUFBTTt3QkFFekMsOENBQThDO3dCQUM5QyxNQUFNdUIsZUFBZSxDQUFDTCxTQUFTRyxJQUFJLElBQUksRUFBQyxFQUFHRyxXQUFXO3dCQUN0RCxNQUFNQyxjQUFjUCxTQUFTbEIsTUFBTSxFQUFFMEIsS0FBSyxDQUFDQyxJQUFXQSxFQUFFQyxNQUFNLEtBQUssSUFBSUM7d0JBRXZFLDZDQUE2Qzt3QkFDN0MsSUFBSSxDQUFDckIsb0JBQW9CLENBQUNlLGFBQWEsRUFBRTs0QkFDdkNmLG9CQUFvQixDQUFDZSxhQUFhLEdBQUc7Z0NBQ25DTyxnQkFBZ0IsSUFBSWQsTUFBTVosUUFBUTJCLElBQUksQ0FBQztnQ0FDdkMvQixRQUFRLEVBQUU7Z0NBQ1ZnQyxVQUFVOzRCQUNaO3dCQUNGO3dCQUVBLGdDQUFnQzt3QkFDaEN4QixvQkFBb0IsQ0FBQ2UsYUFBYSxDQUFDTyxjQUFjLENBQUNoQixTQUFTLEdBQUdJLFNBQVNJLGVBQWUsSUFBSTt3QkFFMUYseUVBQXlFO3dCQUN6RSxJQUFJQyxpQkFBaUIsY0FBYzs0QkFDakMzQyxRQUFRQyxHQUFHLENBQUM7NEJBQ1phLFNBQVMsQ0FBQyxhQUFhLENBQUNJLFVBQVUsQ0FBQ21DLElBQUksQ0FBQ2Y7NEJBQ3hDVixvQkFBb0IsQ0FBQ2UsYUFBYSxDQUFDUyxRQUFRLEdBQUc7NEJBQzlDLDRDQUE0Qzs0QkFDNUMsSUFBSVAsZUFBZUEsY0FBYyxLQUFLLENBQUNQLFNBQVNJLGVBQWUsSUFBSSxLQUFLLEdBQUc7Z0NBQ3pFNUIsU0FBUyxDQUFDLGFBQWEsQ0FBQ00sTUFBTSxDQUFDaUMsSUFBSSxDQUFDUjtnQ0FDcENqQixvQkFBb0IsQ0FBQ2UsYUFBYSxDQUFDdkIsTUFBTSxDQUFDaUMsSUFBSSxDQUFDUjs0QkFDakQ7d0JBQ0YsT0FHSyxJQUFJRixpQkFBaUIsY0FDakJBLGlCQUFpQixjQUNqQkEsaUJBQWlCLFlBQVk7NEJBQ3BDM0MsUUFBUUMsR0FBRyxDQUFDOzRCQUNaYSxTQUFTLENBQUMsbUJBQW1CLENBQUNJLFVBQVUsQ0FBQ21DLElBQUksQ0FBQ2Y7NEJBQzlDVixvQkFBb0IsQ0FBQ2UsYUFBYSxDQUFDUyxRQUFRLEdBQUc7NEJBQzlDLDRDQUE0Qzs0QkFDNUMsSUFBSVAsZUFBZUEsY0FBYyxLQUFLLENBQUNQLFNBQVNJLGVBQWUsSUFBSSxLQUFLLEdBQUc7Z0NBQ3pFNUIsU0FBUyxDQUFDLG1CQUFtQixDQUFDTSxNQUFNLENBQUNpQyxJQUFJLENBQUNSO2dDQUMxQ2pCLG9CQUFvQixDQUFDZSxhQUFhLENBQUN2QixNQUFNLENBQUNpQyxJQUFJLENBQUNSOzRCQUNqRDt3QkFDRixPQUdLLElBQUlGLGlCQUFpQixjQUNqQkEsaUJBQWlCLGNBQ2pCQSxpQkFBaUIsY0FDakJBLGlCQUFpQixZQUFZOzRCQUNwQzNDLFFBQVFDLEdBQUcsQ0FBQzs0QkFDWmEsU0FBUyxDQUFDLGVBQWUsQ0FBQ0ksVUFBVSxDQUFDbUMsSUFBSSxDQUFDZjs0QkFDMUNWLG9CQUFvQixDQUFDZSxhQUFhLENBQUNTLFFBQVEsR0FBRzs0QkFDOUMsNENBQTRDOzRCQUM1QyxJQUFJUCxlQUFlQSxjQUFjLEtBQUssQ0FBQ1AsU0FBU0ksZUFBZSxJQUFJLEtBQUssR0FBRztnQ0FDekU1QixTQUFTLENBQUMsZUFBZSxDQUFDTSxNQUFNLENBQUNpQyxJQUFJLENBQUNSO2dDQUN0Q2pCLG9CQUFvQixDQUFDZSxhQUFhLENBQUN2QixNQUFNLENBQUNpQyxJQUFJLENBQUNSOzRCQUNqRDt3QkFDRixPQUdLOzRCQUNIN0MsUUFBUUMsR0FBRyxDQUFDLENBQUMsMEJBQTBCLEVBQUVxQyxTQUFTRyxJQUFJLENBQUMsQ0FBQyxDQUFDOzRCQUN6RHpDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLDREQUE0RCxDQUFDOzRCQUMxRUQsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLENBQUM7NEJBQ2hERCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxnQ0FBZ0MsQ0FBQzs0QkFDOUNELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlEQUF5RCxDQUFDOzRCQUN2RUQsUUFBUUMsR0FBRyxDQUFDLENBQUMsaUVBQWlFLENBQUM7d0JBQy9FLHNEQUFzRDt3QkFDeEQ7b0JBQ0Y7Z0JBQ0Y7WUFDRjtZQUVBLHNFQUFzRTtZQUN0RXFELE9BQU9DLElBQUksQ0FBQ3pDLFdBQVdrQixPQUFPLENBQUN3QixDQUFBQTtnQkFDN0IsTUFBTUosV0FBV3RDLFNBQVMsQ0FBQzBDLFlBQXNDO2dCQUNqRSxJQUFJQywyQkFBMkI7Z0JBRS9CLG9EQUFvRDtnQkFDcERILE9BQU9JLE9BQU8sQ0FBQzlCLHNCQUFzQkksT0FBTyxDQUFDLENBQUMsQ0FBQ1csY0FBY2dCLGFBQWE7b0JBQ3hFLElBQUlBLGFBQWFQLFFBQVEsS0FBS0ksYUFBYTt3QkFDekMsNEVBQTRFO3dCQUM1RSxNQUFNSSwwQkFBMEJELGFBQWFULGNBQWMsQ0FBQ3ZDLE1BQU0sR0FBRyxJQUNuRWMsS0FBS0ssR0FBRyxJQUFJNkIsYUFBYVQsY0FBYyxJQUFJO3dCQUU3Q2xELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGFBQWEsRUFBRTBDLGFBQWEsV0FBVyxFQUFFZ0IsYUFBYVQsY0FBYyxDQUFDVyxJQUFJLENBQUMsTUFBTSxTQUFTLEVBQUVELHdCQUF3QixDQUFDO3dCQUVqSSwyQ0FBMkM7d0JBQzNDSCw0QkFBNEJHO29CQUM5QjtnQkFDRjtnQkFFQSxrQ0FBa0M7Z0JBQ2xDUixTQUFTakMsbUJBQW1CLEdBQUc7b0JBQUNzQztpQkFBeUIsRUFBRSw0Q0FBNEM7Z0JBRXZHekQsUUFBUUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFdUQsWUFBWSxpQ0FBaUMsRUFBRUMseUJBQXlCLENBQUM7WUFDN0Y7WUFFQSx1Q0FBdUM7WUFDdkMsTUFBTUssaUJBQXdCLEVBQUU7WUFFaEMsaUVBQWlFO1lBQ2pFUixPQUFPSSxPQUFPLENBQUM1QyxXQUFXa0IsT0FBTyxDQUFDLENBQUMsQ0FBQytCLEtBQUtYLFNBQVM7Z0JBQ2hELHlEQUF5RDtnQkFDekQsSUFBSVksYUFBYTtnQkFFakIsSUFBSVosU0FBU2hDLE1BQU0sQ0FBQ1QsTUFBTSxHQUFHLEdBQUc7b0JBQzlCLHNEQUFzRDtvQkFDdEQsSUFBSW9ELFFBQVEsY0FBYzt3QkFDeEIsTUFBTUUsaUJBQWlCYixTQUFTaEMsTUFBTSxDQUFDMEIsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxNQUFNO3dCQUN2RCxJQUFJa0IsZ0JBQWdCOzRCQUNsQkQsYUFBYUM7d0JBQ2YsT0FBTzs0QkFDTCxtQkFBbUI7NEJBQ25CLE1BQU1DLGVBQWVkLFNBQVNoQyxNQUFNLENBQUMrQyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0MsSUFBTUQsSUFBSUM7NEJBQ3hETCxhQUFhRSxZQUFZLENBQUN6QyxLQUFLNkMsS0FBSyxDQUFDSixhQUFhdkQsTUFBTSxHQUFHLEdBQUc7d0JBQ2hFO29CQUNGLE9BQU87d0JBQ0wsbUNBQW1DO3dCQUNuQyxNQUFNdUQsZUFBZWQsU0FBU2hDLE1BQU0sQ0FBQytDLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNRCxJQUFJQzt3QkFDeERMLGFBQWFFLFlBQVksQ0FBQ3pDLEtBQUs2QyxLQUFLLENBQUNKLGFBQWF2RCxNQUFNLEdBQUcsR0FBRztvQkFDaEU7Z0JBQ0Y7Z0JBRUEsMkNBQTJDO2dCQUMzQyxNQUFNNEQsaUJBQWlCbkIsU0FBU2pDLG1CQUFtQixDQUFDUixNQUFNLEdBQUcsSUFBSXlDLFNBQVNqQyxtQkFBbUIsQ0FBQyxFQUFFLEdBQUc7Z0JBRW5HMkMsZUFBZVQsSUFBSSxDQUFDO29CQUNsQnRDLFlBQVlxQyxTQUFTckMsVUFBVTtvQkFDL0JDLGNBQWNvQyxTQUFTcEMsWUFBWTtvQkFDbkN3RCxlQUFlUjtvQkFDZlMsV0FBV1Q7b0JBQ1hVLGFBQWFWLGFBQWEsaUNBQWlDO29CQUMzRC9DLFdBQVdtQyxTQUFTbkMsU0FBUztvQkFDN0I2QyxnQkFBZ0JTO29CQUNoQkksV0FBV0osaUJBQWlCO29CQUM1QkssT0FBTzt3QkFDTEMsa0JBQWtCekIsU0FBU2xDLFVBQVUsQ0FBQyxFQUFFLElBQUk7d0JBQzVDNEQsUUFBUTt3QkFDUkMsZUFBZTNCLFNBQVNsQyxVQUFVLENBQUM4RCxHQUFHLENBQUNDLENBQUFBLElBQUtBLEVBQUV4QyxJQUFJO3dCQUNsRHlDLFdBQVc5QixTQUFTaEMsTUFBTTt3QkFDMUJELHFCQUFxQmlDLFNBQVNqQyxtQkFBbUI7d0JBQ2pEZ0UsbUJBQW1CWjtvQkFDckI7Z0JBQ0Y7WUFDRjtZQUVBdkUsUUFBUUMsR0FBRyxDQUFDO1lBQ1pELFFBQVFDLEdBQUcsQ0FBQyxpQ0FBdUI2RCxlQUFlbkQsTUFBTTtZQUN4RG1ELGVBQWU5QixPQUFPLENBQUMsQ0FBQ29ELE1BQU1DO2dCQUM1QnJGLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRW9GLFFBQVEsRUFBRSxFQUFFLEVBQUVELEtBQUtwRSxZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUNwRGhCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFbUYsS0FBS1gsU0FBUyxDQUFDLEVBQUUsRUFBRVcsS0FBS1YsV0FBVyxJQUFJLFdBQVcsQ0FBQyxDQUFDO2dCQUN0RjFFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGtCQUFrQixFQUFFbUYsS0FBS3RCLGNBQWMsQ0FBQyxrQkFBa0IsQ0FBQztnQkFDeEU5RCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUVtRixLQUFLUixLQUFLLENBQUN6RCxtQkFBbUIsQ0FBQzBDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDMUU3RCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxtQkFBbUIsRUFBRW1GLEtBQUtSLEtBQUssQ0FBQ00sU0FBUyxDQUFDckIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNwRTdELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG9CQUFvQixFQUFFbUYsS0FBS1IsS0FBSyxDQUFDRyxhQUFhLENBQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDM0U7WUFFQSxJQUFJQyxlQUFlbkQsTUFBTSxLQUFLLEdBQUc7Z0JBQ2pDLE9BQU9qQixrRkFBWUEsQ0FBQ1MsSUFBSSxDQUFDO29CQUNyQm1GLFNBQVM7b0JBQ1RDLE9BQU87b0JBQ1BYLE9BQU87d0JBQ0xZLG9CQUFvQmpGLGlCQUFpQkksTUFBTTt3QkFDM0NKLGtCQUFrQkE7d0JBQ2xCa0YsU0FBUztvQkFDWDtnQkFDRixHQUFHO29CQUFFQyxRQUFRO2dCQUFJO1lBQ25CO1lBRUEsTUFBTUMsU0FBUztnQkFDYkwsU0FBUztnQkFDVFgsV0FBVztnQkFDWDFELFdBQVc7Z0JBQ1g2QyxnQkFBZ0JBO2dCQUNoQmMsT0FBTztvQkFDTGdCLGtCQUFrQnJGLGlCQUFpQkksTUFBTTtvQkFDekNrRixjQUFjO29CQUNkQyxlQUFlaEMsZUFBZWtCLEdBQUcsQ0FBQ2UsQ0FBQUEsSUFBTTs0QkFDdENYLE1BQU1XLEVBQUUvRSxZQUFZOzRCQUNwQmdGLE9BQU9ELEVBQUV2QixhQUFhOzRCQUN0QkMsV0FBV3NCLEVBQUV0QixTQUFTOzRCQUN0QkssUUFBUWlCLEVBQUVyQixXQUFXO3dCQUN2QjtnQkFDRjtZQUNGO1lBRUEsb0RBQW9EO1lBQ3BELHlDQUF5QztZQUN6QzFFLFFBQVFDLEdBQUcsQ0FBQyx5RUFBK0RXLEtBQUtDLFNBQVMsQ0FBQzhFLFFBQVEsTUFBTTtZQUN4RyxPQUFPakcsa0ZBQVlBLENBQUNTLElBQUksQ0FBQ3dGO1FBRTNCLEVBQUUsT0FBT00sVUFBZTtZQUN0QmpHLFFBQVF1RixLQUFLLENBQUMseUJBQXlCVSxTQUFTUixPQUFPO1lBQ3ZEekYsUUFBUXVGLEtBQUssQ0FBQyx5QkFBeUI7Z0JBQ3JDRSxTQUFTUSxTQUFTUixPQUFPO2dCQUN6QmhELE1BQU13RCxTQUFTeEQsSUFBSTtnQkFDbkJ5RCxPQUFPRCxTQUFTQyxLQUFLO2dCQUNyQkMsVUFBVUYsU0FBU0UsUUFBUSxFQUFFQztZQUMvQjtZQUVBLDhDQUE4QztZQUM5QyxNQUFNQyxjQUFjSixTQUFTUixPQUFPLElBQUlRLFNBQVNSLE9BQU8sQ0FBQ2EsUUFBUSxDQUFDO1lBRWxFLE9BQU81RyxrRkFBWUEsQ0FBQ1MsSUFBSSxDQUFDO2dCQUN2Qm1GLFNBQVM7Z0JBQ1RDLE9BQU9jLGNBQ0gsdUdBQ0E7Z0JBQ0p6QixPQUFPO29CQUNMMkIsV0FBV04sU0FBU3hELElBQUk7b0JBQ3hCZ0QsU0FBU1EsU0FBU1IsT0FBTztvQkFDekJlLFlBQVlILGNBQ1Isc0ZBQ0E7b0JBQ0pSLGNBQWM7b0JBQ2RRLGFBQWFBO29CQUNiSSxXQUFXLElBQUluRixPQUFPb0YsV0FBVztnQkFDbkM7WUFDRixHQUFHO2dCQUFFaEIsUUFBUTtZQUFJO1FBQ25CO0lBRUYsRUFBRSxPQUFPSCxPQUFZO1FBQ25CdkYsUUFBUXVGLEtBQUssQ0FBQyxpQ0FBaUNBO1FBRS9DLE9BQU83RixrRkFBWUEsQ0FBQ1MsSUFBSSxDQUFDO1lBQ3ZCbUYsU0FBUztZQUNUQyxPQUFPO1lBQ1BvQixTQUFTcEIsTUFBTUUsT0FBTztRQUN4QixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNuQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc3VyZmNhbXAtYm9va2luZy1zeXN0ZW0vLi9hcHAvYXBpL2F2YWlsYWJpbGl0eS9yb3V0ZS50cz8xM2YyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBMb2JieVBNU0F2YWlsYWJpbGl0eVJlc3BvbnNlIH0gZnJvbSAnQC90eXBlcyc7XG5pbXBvcnQgeyBsb2JieVBNU0NsaWVudCB9IGZyb20gJ0AvbGliL2xvYmJ5cG1zJztcbmltcG9ydCB7IHNlbmRXaGF0c0FwcE1lc3NhZ2UgfSBmcm9tICdAL2xpYi93aGF0c2FwcCc7XG5cbmNvbnN0IHNlbnRXaGF0c0FwcFNldCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn46vIEF2YWlsYWJpbGl0eSBBUEkgY2FsbGVkIC0gU1RBUlQnKTtcbiAgICBcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc3QgeyBjaGVja0luLCBjaGVja091dCwgZ3Vlc3RzIH0gPSBib2R5O1xuXG4gICAgY29uc29sZS5sb2coJ/Cfjq8gQXZhaWxhYmlsaXR5IEFQSSBjYWxsZWQgd2l0aDonLCB7IGNoZWNrSW4sIGNoZWNrT3V0LCBndWVzdHMgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/CfmoAgQ2FsbGluZyBMb2JieVBNUyBBUEkgd2l0aCBDT1JSRUNUIGVuZHBvaW50Li4uJyk7XG4gICAgICBcbiAgICAgIC8vIFVzZSB0aGUgY29ycmVjdCBlbmRwb2ludDogL2F2YWlsYWJsZS1yb29tc1xuICAgICAgY29uc3QgYXZhaWxhYmlsaXR5RGF0YSA9IGF3YWl0IGxvYmJ5UE1TQ2xpZW50LmdldEF2YWlsYWJsZVJvb21zKHtcbiAgICAgICAgc3RhcnRfZGF0ZTogY2hlY2tJbixcbiAgICAgICAgZW5kX2RhdGU6IGNoZWNrT3V0LFxuICAgICAgICAvLyBOb3RlOiBndWVzdF9jb3VudCBpcyBub3QgYSBwYXJhbWV0ZXIgZm9yIHRoaXMgZW5kcG9pbnQgYWNjb3JkaW5nIHRvIGRvY3NcbiAgICAgIH0pO1xuXG4gICAgICBjb25zb2xlLmxvZygn8J+TiyA9PT09PSBBVkFJTEFCSUxJVFkgREFUQSBSRUNFSVZFRCA9PT09PScpO1xuICAgICAgY29uc29sZS5sb2coJ/Cfk4sgVG90YWwgZGF5cyByZWNlaXZlZDonLCBhdmFpbGFiaWxpdHlEYXRhLmxlbmd0aCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+TiyBSYXcgYXZhaWxhYmlsaXR5IGRhdGE6JywgSlNPTi5zdHJpbmdpZnkoYXZhaWxhYmlsaXR5RGF0YSwgbnVsbCwgMikpO1xuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIHRoZSBhdmFpbGFiaWxpdHkgZGF0YSB0byBleHRyYWN0IHJvb21zIGFuZCBwcmljZXNcbiAgICAgIGNvbnN0IHJvb21UeXBlcyA9IHtcbiAgICAgICAgJ2Nhc2EtcGxheWEnOiB7XG4gICAgICAgICAgcm9vbVR5cGVJZDogJ2Nhc2EtcGxheWEnLFxuICAgICAgICAgIHJvb21UeXBlTmFtZTogJ0Nhc2EgZGUgUGxheWEgKEN1YXJ0byBDb21wYXJ0aWRvKScsXG4gICAgICAgICAgbWF4R3Vlc3RzOiA4LFxuICAgICAgICAgIGNhdGVnb3JpZXM6IFtdIGFzIGFueVtdLFxuICAgICAgICAgIGF2YWlsYWJsZVJvb21zQnlEYXk6IFtdIGFzIG51bWJlcltdLFxuICAgICAgICAgIHByaWNlczogW10gYXMgbnVtYmVyW11cbiAgICAgICAgfSxcbiAgICAgICAgJ2Nhc2l0YXMtcHJpdmFkYXMnOiB7XG4gICAgICAgICAgcm9vbVR5cGVJZDogJ2Nhc2l0YXMtcHJpdmFkYXMnLFxuICAgICAgICAgIHJvb21UeXBlTmFtZTogJ0Nhc2l0YXMgUHJpdmFkYXMnLFxuICAgICAgICAgIG1heEd1ZXN0czogMixcbiAgICAgICAgICBjYXRlZ29yaWVzOiBbXSBhcyBhbnlbXSxcbiAgICAgICAgICBhdmFpbGFibGVSb29tc0J5RGF5OiBbXSBhcyBudW1iZXJbXSxcbiAgICAgICAgICBwcmljZXM6IFtdIGFzIG51bWJlcltdXG4gICAgICAgIH0sXG4gICAgICAgICdjYXNhcy1kZWx1eGUnOiB7XG4gICAgICAgICAgcm9vbVR5cGVJZDogJ2Nhc2FzLWRlbHV4ZScsXG4gICAgICAgICAgcm9vbVR5cGVOYW1lOiAnQ2FzYXMgRGVsdXhlJyxcbiAgICAgICAgICBtYXhHdWVzdHM6IDIsXG4gICAgICAgICAgY2F0ZWdvcmllczogW10gYXMgYW55W10sXG4gICAgICAgICAgYXZhaWxhYmxlUm9vbXNCeURheTogW10gYXMgbnVtYmVyW10sXG4gICAgICAgICAgcHJpY2VzOiBbXSBhcyBudW1iZXJbXVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgbnVtYmVyIG9mIG5pZ2h0cyAobm90IGRheXMpXG4gICAgICAvLyBGb3IgY2hlY2staW4gMTcvNyBhbmQgY2hlY2stb3V0IDE4LzcsIHdlIG9ubHkgbmVlZCB0byB2ZXJpZnkgbmlnaHQgb2YgMTcvN1xuICAgICAgY29uc3QgY2hlY2tJbkRhdGUgPSBuZXcgRGF0ZShjaGVja0luKTtcbiAgICAgIGNvbnN0IGNoZWNrT3V0RGF0ZSA9IG5ldyBEYXRlKGNoZWNrT3V0KTtcbiAgICAgIGNvbnN0IG5pZ2h0cyA9IE1hdGguY2VpbCgoY2hlY2tPdXREYXRlLmdldFRpbWUoKSAtIGNoZWNrSW5EYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhg8J+ThSBDaGVjay1pbjogJHtjaGVja0lufSwgQ2hlY2stb3V0OiAke2NoZWNrT3V0fWApO1xuICAgICAgY29uc29sZS5sb2coYPCfk4UgTmlnaHRzIG5lZWRlZDogJHtuaWdodHN9YCk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+ThSBXaWxsIG9ubHkgcHJvY2VzcyBmaXJzdCAke25pZ2h0c30gZGF5cyBmb3IgYXZhaWxhYmlsaXR5YCk7XG4gICAgICBcbiAgICAgIC8vIFRyYWNrIGluZGl2aWR1YWwgY2F0ZWdvcmllcyBmb3IgcHJvcGVyIGF2YWlsYWJpbGl0eSBjYWxjdWxhdGlvblxuICAgICAgY29uc3QgaW5kaXZpZHVhbENhdGVnb3JpZXM6IHsgW2tleTogc3RyaW5nXTogeyBhdmFpbGFibGVCeURheTogbnVtYmVyW10sIHByaWNlczogbnVtYmVyW10sIHJvb21UeXBlOiBzdHJpbmcgfSB9ID0ge307XG4gICAgICBcbiAgICAgIC8vIE9ubHkgcHJvY2VzcyB0aGUgZGF5cyB3ZSBuZWVkIChudW1iZXIgb2YgbmlnaHRzKVxuICAgICAgY29uc3QgZGF5c1RvUHJvY2VzcyA9IE1hdGgubWluKG5pZ2h0cywgYXZhaWxhYmlsaXR5RGF0YS5sZW5ndGgpO1xuICAgICAgYXZhaWxhYmlsaXR5RGF0YS5zbGljZSgwLCBkYXlzVG9Qcm9jZXNzKS5mb3JFYWNoKChkYXlEYXRhLCBkYXlJbmRleCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+ThSBQcm9jZXNzaW5nIGRheSAke2RheUluZGV4ICsgMX06ICR7ZGF5RGF0YS5kYXRlfWApO1xuICAgICAgICBcbiAgICAgICAgaWYgKGRheURhdGEuY2F0ZWdvcmllcyAmJiBBcnJheS5pc0FycmF5KGRheURhdGEuY2F0ZWdvcmllcykpIHtcbiAgICAgICAgICBkYXlEYXRhLmNhdGVnb3JpZXMuZm9yRWFjaCgoY2F0ZWdvcnk6IGFueSwgY2F0SW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYPCfj6AgPT09PT0gUFJPQ0VTU0lORyBDQVRFR09SWSAke2NhdEluZGV4ICsgMX0gPT09PT1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn4+gIENhdGVnb3J5IElEOiAke2NhdGVnb3J5LmNhdGVnb3J5X2lkfWApO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYPCfj6AgQ2F0ZWdvcnkgbmFtZTogXCIke2NhdGVnb3J5Lm5hbWV9XCJgKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn4+gIEF2YWlsYWJsZSByb29tczogJHtjYXRlZ29yeS5hdmFpbGFibGVfcm9vbXN9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg8J+PoCBQcmljZXM6YCwgY2F0ZWdvcnkucHJpY2VzKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTWFwIGNhdGVnb3JpZXMgdG8gb3VyIDMgYWNjb21tb2RhdGlvbiB0eXBlc1xuICAgICAgICAgICAgY29uc3QgY2F0ZWdvcnlOYW1lID0gKGNhdGVnb3J5Lm5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBjb25zdCBzaW5nbGVQcmljZSA9IGNhdGVnb3J5LnByaWNlcz8uZmluZCgocDogYW55KSA9PiBwLnBlb3BsZSA9PT0gMSk/LnZhbHVlO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIGNhdGVnb3J5IHRyYWNraW5nIGlmIG5vdCBleGlzdHNcbiAgICAgICAgICAgIGlmICghaW5kaXZpZHVhbENhdGVnb3JpZXNbY2F0ZWdvcnlOYW1lXSkge1xuICAgICAgICAgICAgICBpbmRpdmlkdWFsQ2F0ZWdvcmllc1tjYXRlZ29yeU5hbWVdID0ge1xuICAgICAgICAgICAgICAgIGF2YWlsYWJsZUJ5RGF5OiBuZXcgQXJyYXkobmlnaHRzKS5maWxsKDApLFxuICAgICAgICAgICAgICAgIHByaWNlczogW10sXG4gICAgICAgICAgICAgICAgcm9vbVR5cGU6ICcnXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFNldCBhdmFpbGFiaWxpdHkgZm9yIHRoaXMgZGF5XG4gICAgICAgICAgICBpbmRpdmlkdWFsQ2F0ZWdvcmllc1tjYXRlZ29yeU5hbWVdLmF2YWlsYWJsZUJ5RGF5W2RheUluZGV4XSA9IGNhdGVnb3J5LmF2YWlsYWJsZV9yb29tcyB8fCAwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyAxLiBDQVNBIERFIFBMQVlBOiBTT0xPIFwiQ2FzYSBQbGF5YVwiIChsYXMgOCBjYW1hcyBkZW50cm8gZGUgQ2FzYSBQbGF5YSlcbiAgICAgICAgICAgIGlmIChjYXRlZ29yeU5hbWUgPT09ICdjYXNhIHBsYXlhJykge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIE1hdGNoZWQgYXMgQ2FzYSBkZSBQbGF5YSAoQ3VhcnRvIENvbXBhcnRpZG8pJyk7XG4gICAgICAgICAgICAgIHJvb21UeXBlc1snY2FzYS1wbGF5YSddLmNhdGVnb3JpZXMucHVzaChjYXRlZ29yeSk7XG4gICAgICAgICAgICAgIGluZGl2aWR1YWxDYXRlZ29yaWVzW2NhdGVnb3J5TmFtZV0ucm9vbVR5cGUgPSAnY2FzYS1wbGF5YSc7XG4gICAgICAgICAgICAgIC8vIFNvbG8gYWdyZWdhciBwcmVjaW8gc2kgaGF5IGRpc3BvbmliaWxpZGFkXG4gICAgICAgICAgICAgIGlmIChzaW5nbGVQcmljZSAmJiBzaW5nbGVQcmljZSA+IDAgJiYgKGNhdGVnb3J5LmF2YWlsYWJsZV9yb29tcyB8fCAwKSA+IDApIHtcbiAgICAgICAgICAgICAgICByb29tVHlwZXNbJ2Nhc2EtcGxheWEnXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgICAgaW5kaXZpZHVhbENhdGVnb3JpZXNbY2F0ZWdvcnlOYW1lXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gMi4gQ0FTSVRBUyBQUklWQURBUzogU09MTyBjYXNpdGEgMywgY2FzaXRhIDQsIGNhc2l0YSA3XG4gICAgICAgICAgICBlbHNlIGlmIChjYXRlZ29yeU5hbWUgPT09ICdjYXNpdGEgMycgfHwgXG4gICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPT09ICdjYXNpdGEgNCcgfHwgXG4gICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPT09ICdjYXNpdGEgNycpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBNYXRjaGVkIGFzIENhc2l0YSBQcml2YWRhJyk7XG4gICAgICAgICAgICAgIHJvb21UeXBlc1snY2FzaXRhcy1wcml2YWRhcyddLmNhdGVnb3JpZXMucHVzaChjYXRlZ29yeSk7XG4gICAgICAgICAgICAgIGluZGl2aWR1YWxDYXRlZ29yaWVzW2NhdGVnb3J5TmFtZV0ucm9vbVR5cGUgPSAnY2FzaXRhcy1wcml2YWRhcyc7XG4gICAgICAgICAgICAgIC8vIFNvbG8gYWdyZWdhciBwcmVjaW8gc2kgaGF5IGRpc3BvbmliaWxpZGFkXG4gICAgICAgICAgICAgIGlmIChzaW5nbGVQcmljZSAmJiBzaW5nbGVQcmljZSA+IDAgJiYgKGNhdGVnb3J5LmF2YWlsYWJsZV9yb29tcyB8fCAwKSA+IDApIHtcbiAgICAgICAgICAgICAgICByb29tVHlwZXNbJ2Nhc2l0YXMtcHJpdmFkYXMnXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgICAgaW5kaXZpZHVhbENhdGVnb3JpZXNbY2F0ZWdvcnlOYW1lXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gMy4gQ0FTQVMgREVMVVhFOiBTT0xPIFN0dWRpbyAxLCBTdHVkaW8gMiwgQ2FzaXRhIDUsIENhc2l0YSA2XG4gICAgICAgICAgICBlbHNlIGlmIChjYXRlZ29yeU5hbWUgPT09ICdzdHVkaW8gMScgfHwgXG4gICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPT09ICdzdHVkaW8gMicgfHwgXG4gICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPT09ICdjYXNpdGEgNScgfHwgXG4gICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeU5hbWUgPT09ICdjYXNpdGEgNicpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KchSBNYXRjaGVkIGFzIENhc2EgRGVsdXhlJyk7XG4gICAgICAgICAgICAgIHJvb21UeXBlc1snY2FzYXMtZGVsdXhlJ10uY2F0ZWdvcmllcy5wdXNoKGNhdGVnb3J5KTtcbiAgICAgICAgICAgICAgaW5kaXZpZHVhbENhdGVnb3JpZXNbY2F0ZWdvcnlOYW1lXS5yb29tVHlwZSA9ICdjYXNhcy1kZWx1eGUnO1xuICAgICAgICAgICAgICAvLyBTb2xvIGFncmVnYXIgcHJlY2lvIHNpIGhheSBkaXNwb25pYmlsaWRhZFxuICAgICAgICAgICAgICBpZiAoc2luZ2xlUHJpY2UgJiYgc2luZ2xlUHJpY2UgPiAwICYmIChjYXRlZ29yeS5hdmFpbGFibGVfcm9vbXMgfHwgMCkgPiAwKSB7XG4gICAgICAgICAgICAgICAgcm9vbVR5cGVzWydjYXNhcy1kZWx1eGUnXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgICAgaW5kaXZpZHVhbENhdGVnb3JpZXNbY2F0ZWdvcnlOYW1lXS5wcmljZXMucHVzaChzaW5nbGVQcmljZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gNC4gQ0FURUdPUsONQVMgTk8gVsOBTElEQVMgXG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYOKdjCBDQVRFR09SWSBOT1QgSU5DTFVERUQ6IFwiJHtjYXRlZ29yeS5uYW1lfVwiYCk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGDinYwgVGhpcyBjYXRlZ29yeSBpcyBub3QgcGFydCBvZiB0aGUgdmFsaWQgYWNjb21tb2RhdGlvbiB0eXBlc2ApO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhg4p2MIE9ubHkgdGhlc2UgY2F0ZWdvcmllcyBhcmUgdmFsaWQ6YCk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgICAtIENhc2EgZGUgUGxheWE6IFwiQ2FzYSBQbGF5YVwiYCk7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgICAtIENhc2l0YXMgUHJpdmFkYXM6IFwiQ2FzaXRhIDNcIiwgXCJDYXNpdGEgNFwiLCBcIkNhc2l0YSA3XCJgKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coYCAgIC0gQ2FzYXMgRGVsdXhlOiBcIlN0dWRpbyAxXCIsIFwiU3R1ZGlvIDJcIiwgXCJDYXNpdGEgNVwiLCBcIkNhc2l0YSA2XCJgKTtcbiAgICAgICAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZyBidXQgZG9uJ3QgaW5jbHVkZSB0aGlzIGNhdGVnb3J5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBDYWxjdWxhdGUgdG90YWwgYXZhaWxhYmlsaXR5IGZvciBlYWNoIHJvb20gdHlwZSB1c2luZyBjb3JyZWN0IGxvZ2ljXG4gICAgICBPYmplY3Qua2V5cyhyb29tVHlwZXMpLmZvckVhY2gocm9vbVR5cGVLZXkgPT4ge1xuICAgICAgICBjb25zdCByb29tVHlwZSA9IHJvb21UeXBlc1tyb29tVHlwZUtleSBhcyBrZXlvZiB0eXBlb2Ygcm9vbVR5cGVzXTtcbiAgICAgICAgbGV0IHRvdGFsQXZhaWxhYmxlRm9yQWxsRGF5cyA9IDA7XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIGFsbCBjYXRlZ29yaWVzIHRoYXQgYmVsb25nIHRvIHRoaXMgcm9vbSB0eXBlXG4gICAgICAgIE9iamVjdC5lbnRyaWVzKGluZGl2aWR1YWxDYXRlZ29yaWVzKS5mb3JFYWNoKChbY2F0ZWdvcnlOYW1lLCBjYXRlZ29yeURhdGFdKSA9PiB7XG4gICAgICAgICAgaWYgKGNhdGVnb3J5RGF0YS5yb29tVHlwZSA9PT0gcm9vbVR5cGVLZXkpIHtcbiAgICAgICAgICAgIC8vIEZvciBlYWNoIGluZGl2aWR1YWwgY2F0ZWdvcnksIGNhbGN1bGF0ZSBtaW5pbXVtIGF2YWlsYWJsZSBhY3Jvc3MgYWxsIGRheXNcbiAgICAgICAgICAgIGNvbnN0IG1pbkF2YWlsYWJsZUZvckNhdGVnb3J5ID0gY2F0ZWdvcnlEYXRhLmF2YWlsYWJsZUJ5RGF5Lmxlbmd0aCA+IDAgPyBcbiAgICAgICAgICAgICAgTWF0aC5taW4oLi4uY2F0ZWdvcnlEYXRhLmF2YWlsYWJsZUJ5RGF5KSA6IDA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDwn4+gIENhdGVnb3J5IFwiJHtjYXRlZ29yeU5hbWV9XCIgLSBEYXlzOiBbJHtjYXRlZ29yeURhdGEuYXZhaWxhYmxlQnlEYXkuam9pbignLCAnKX1dIC0gTWluOiAke21pbkF2YWlsYWJsZUZvckNhdGVnb3J5fWApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBZGQgdGhpcyBjYXRlZ29yeSdzIG1pbmltdW0gdG8gdGhlIHRvdGFsXG4gICAgICAgICAgICB0b3RhbEF2YWlsYWJsZUZvckFsbERheXMgKz0gbWluQXZhaWxhYmxlRm9yQ2F0ZWdvcnk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aGUgY2FsY3VsYXRlZCBhdmFpbGFiaWxpdHlcbiAgICAgICAgcm9vbVR5cGUuYXZhaWxhYmxlUm9vbXNCeURheSA9IFt0b3RhbEF2YWlsYWJsZUZvckFsbERheXNdOyAvLyBTaW5nbGUgdmFsdWUgcmVwcmVzZW50aW5nIHRvdGFsIGF2YWlsYWJsZVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYPCfjq8gJHtyb29tVHlwZUtleX0gLSBUb3RhbCBhdmFpbGFibGUgZm9yIGFsbCBkYXlzOiAke3RvdGFsQXZhaWxhYmxlRm9yQWxsRGF5c31gKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDb252ZXJ0IGdyb3VwZWQgZGF0YSB0byBmaW5hbCBmb3JtYXRcbiAgICAgIGNvbnN0IGF2YWlsYWJsZVJvb21zOiBhbnlbXSA9IFtdO1xuICAgICAgXG4gICAgICAvLyBBTFdBWVMgcmV0dXJuIGFsbCAzIGFjY29tbW9kYXRpb24gdHlwZXMsIGV2ZW4gaWYgbm90IGF2YWlsYWJsZVxuICAgICAgT2JqZWN0LmVudHJpZXMocm9vbVR5cGVzKS5mb3JFYWNoKChba2V5LCByb29tVHlwZV0pID0+IHtcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHJlcHJlc2VudGF0aXZlIHByaWNlIChtZWRpYW4gb3IgbW9zdCBjb21tb24pXG4gICAgICAgIGxldCBmaW5hbFByaWNlID0gbnVsbDtcbiAgICAgICAgXG4gICAgICAgIGlmIChyb29tVHlwZS5wcmljZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIFVzZSB0aGUgc3BlY2lhbCBwcmljZSBmb3IgXCJDYXNhIFBsYXlhXCIgaWYgaXQgZXhpc3RzXG4gICAgICAgICAgaWYgKGtleSA9PT0gJ2Nhc2EtcGxheWEnKSB7XG4gICAgICAgICAgICBjb25zdCBjYXNhUGxheWFQcmljZSA9IHJvb21UeXBlLnByaWNlcy5maW5kKHAgPT4gcCA9PT0gMjApO1xuICAgICAgICAgICAgaWYgKGNhc2FQbGF5YVByaWNlKSB7XG4gICAgICAgICAgICAgIGZpbmFsUHJpY2UgPSBjYXNhUGxheWFQcmljZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIFVzZSBtZWRpYW4gcHJpY2VcbiAgICAgICAgICAgICAgY29uc3Qgc29ydGVkUHJpY2VzID0gcm9vbVR5cGUucHJpY2VzLnNvcnQoKGEsIGIpID0+IGEgLSBiKTtcbiAgICAgICAgICAgICAgZmluYWxQcmljZSA9IHNvcnRlZFByaWNlc1tNYXRoLmZsb29yKHNvcnRlZFByaWNlcy5sZW5ndGggLyAyKV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFVzZSBtZWRpYW4gcHJpY2UgZm9yIG90aGVyIHR5cGVzXG4gICAgICAgICAgICBjb25zdCBzb3J0ZWRQcmljZXMgPSByb29tVHlwZS5wcmljZXMuc29ydCgoYSwgYikgPT4gYSAtIGIpO1xuICAgICAgICAgICAgZmluYWxQcmljZSA9IHNvcnRlZFByaWNlc1tNYXRoLmZsb29yKHNvcnRlZFByaWNlcy5sZW5ndGggLyAyKV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgcm9vbSB0eXBlIHJlZ2FyZGxlc3Mgb2YgYXZhaWxhYmlsaXR5XG4gICAgICAgIGNvbnN0IHRvdGFsQXZhaWxhYmxlID0gcm9vbVR5cGUuYXZhaWxhYmxlUm9vbXNCeURheS5sZW5ndGggPiAwID8gcm9vbVR5cGUuYXZhaWxhYmxlUm9vbXNCeURheVswXSA6IDA7XG4gICAgICAgIFxuICAgICAgICBhdmFpbGFibGVSb29tcy5wdXNoKHtcbiAgICAgICAgICByb29tVHlwZUlkOiByb29tVHlwZS5yb29tVHlwZUlkLFxuICAgICAgICAgIHJvb21UeXBlTmFtZTogcm9vbVR5cGUucm9vbVR5cGVOYW1lLFxuICAgICAgICAgIHByaWNlUGVyTmlnaHQ6IGZpbmFsUHJpY2UsXG4gICAgICAgICAgcmVhbFByaWNlOiBmaW5hbFByaWNlLFxuICAgICAgICAgIHByaWNlU291cmNlOiBmaW5hbFByaWNlID8gJ0xPQkJZUE1TX0FWQUlMQUJMRV9ST09NU19BUEknIDogbnVsbCxcbiAgICAgICAgICBtYXhHdWVzdHM6IHJvb21UeXBlLm1heEd1ZXN0cyxcbiAgICAgICAgICBhdmFpbGFibGVSb29tczogdG90YWxBdmFpbGFibGUsXG4gICAgICAgICAgYXZhaWxhYmxlOiB0b3RhbEF2YWlsYWJsZSA+IDAsXG4gICAgICAgICAgZGVidWc6IHtcbiAgICAgICAgICAgIG9yaWdpbmFsQ2F0ZWdvcnk6IHJvb21UeXBlLmNhdGVnb3JpZXNbMF0gfHwgbnVsbCwgLy8gRmlyc3QgY2F0ZWdvcnkgYXMgZXhhbXBsZSAobnVsbCBpZiBub25lKVxuICAgICAgICAgICAgc291cmNlOiAnYXZhaWxhYmxlLXJvb21zLWVuZHBvaW50JyxcbiAgICAgICAgICAgIGFsbENhdGVnb3JpZXM6IHJvb21UeXBlLmNhdGVnb3JpZXMubWFwKGMgPT4gYy5uYW1lKSxcbiAgICAgICAgICAgIGFsbFByaWNlczogcm9vbVR5cGUucHJpY2VzLFxuICAgICAgICAgICAgYXZhaWxhYmxlUm9vbXNCeURheTogcm9vbVR5cGUuYXZhaWxhYmxlUm9vbXNCeURheSxcbiAgICAgICAgICAgIG1pbkF2YWlsYWJsZVJvb21zOiB0b3RhbEF2YWlsYWJsZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgY29uc29sZS5sb2coJ/Cfjq8gPT09PT0gRklOQUwgUkVTVUxUIFdJVEggUkVBTCBQUklDRVMgPT09PT0nKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn46vIEF2YWlsYWJsZSByb29tczonLCBhdmFpbGFibGVSb29tcy5sZW5ndGgpO1xuICAgICAgYXZhaWxhYmxlUm9vbXMuZm9yRWFjaCgocm9vbSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYPCfj6AgJHtpbmRleCArIDF9LiAke3Jvb20ucm9vbVR5cGVOYW1lfTpgKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgIPCfkrAgUmVhbCBQcmljZTogJCR7cm9vbS5yZWFsUHJpY2V9ICgke3Jvb20ucHJpY2VTb3VyY2UgfHwgJ05PX1BSSUNFJ30pYCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgICDwn5uP77iPIEF2YWlsYWJsZTogJHtyb29tLmF2YWlsYWJsZVJvb21zfSAobWluIGFjcm9zcyBkYXlzKWApO1xuICAgICAgICBjb25zb2xlLmxvZyhgICAg8J+ThSBCeSBkYXk6IFske3Jvb20uZGVidWcuYXZhaWxhYmxlUm9vbXNCeURheS5qb2luKCcsICcpfV1gKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAgIPCfk4ogQWxsIHByaWNlczogWyR7cm9vbS5kZWJ1Zy5hbGxQcmljZXMuam9pbignLCAnKX1dYCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgICDwn4+377iPIENhdGVnb3JpZXM6IFske3Jvb20uZGVidWcuYWxsQ2F0ZWdvcmllcy5qb2luKCcsICcpfV1gKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoYXZhaWxhYmxlUm9vbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiAnTm8gcm9vbXMgYXZhaWxhYmxlIGZvciB0aGUgc2VsZWN0ZWQgZGF0ZXMnLFxuICAgICAgICAgIGRlYnVnOiB7XG4gICAgICAgICAgICB0b3RhbERheXNQcm9jZXNzZWQ6IGF2YWlsYWJpbGl0eURhdGEubGVuZ3RoLFxuICAgICAgICAgICAgYXZhaWxhYmlsaXR5RGF0YTogYXZhaWxhYmlsaXR5RGF0YSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdObyBtYXRjaGluZyByb29tIGNhdGVnb3JpZXMgZm91bmQnXG4gICAgICAgICAgfVxuICAgICAgICB9LCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGF2YWlsYWJsZTogdHJ1ZSxcbiAgICAgICAgbWF4R3Vlc3RzOiAxMixcbiAgICAgICAgYXZhaWxhYmxlUm9vbXM6IGF2YWlsYWJsZVJvb21zLFxuICAgICAgICBkZWJ1Zzoge1xuICAgICAgICAgIHRvdGFsRGF5c0Zyb21BUEk6IGF2YWlsYWJpbGl0eURhdGEubGVuZ3RoLFxuICAgICAgICAgIGVuZHBvaW50VXNlZDogJy9hdmFpbGFibGUtcm9vbXMnLFxuICAgICAgICAgIHByaWNlQW5hbHlzaXM6IGF2YWlsYWJsZVJvb21zLm1hcChyID0+ICh7XG4gICAgICAgICAgICByb29tOiByLnJvb21UeXBlTmFtZSxcbiAgICAgICAgICAgIHByaWNlOiByLnByaWNlUGVyTmlnaHQsXG4gICAgICAgICAgICByZWFsUHJpY2U6IHIucmVhbFByaWNlLFxuICAgICAgICAgICAgc291cmNlOiByLnByaWNlU291cmNlXG4gICAgICAgICAgfSkpXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIEVsaW1pbmFyIHRvZGEgbGEgbMOzZ2ljYSBkZSBlbnbDrW8gZGUgV2hhdHNBcHAgYXF1w61cbiAgICAgIC8vIFNvbG8gZGV2b2x2ZXIgbGEgcmVzcHVlc3RhIG5vcm1hbG1lbnRlXG4gICAgICBjb25zb2xlLmxvZygn8J+TpCBSZXR1cm5pbmcgcmVzdWx0IHdpdGggUkVBTCBwcmljZXMgZnJvbSBjb3JyZWN0IGVuZHBvaW50OicsIEpTT04uc3RyaW5naWZ5KHJlc3VsdCwgbnVsbCwgMikpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdCk7XG5cbiAgICB9IGNhdGNoIChhcGlFcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgTG9iYnlQTVMgQVBJIGVycm9yOicsIGFwaUVycm9yLm1lc3NhZ2UpO1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIEZ1bGwgZXJyb3IgZGV0YWlsczonLCB7XG4gICAgICAgIG1lc3NhZ2U6IGFwaUVycm9yLm1lc3NhZ2UsXG4gICAgICAgIG5hbWU6IGFwaUVycm9yLm5hbWUsXG4gICAgICAgIHN0YWNrOiBhcGlFcnJvci5zdGFjayxcbiAgICAgICAgcmVzcG9uc2U6IGFwaUVycm9yLnJlc3BvbnNlPy5kYXRhXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gRGV0ZXJtaW5lIGlmIHRoaXMgaXMgYW4gSFRNTCByZXNwb25zZSBlcnJvclxuICAgICAgY29uc3QgaXNIdG1sRXJyb3IgPSBhcGlFcnJvci5tZXNzYWdlICYmIGFwaUVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0hUTUwnKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBpc0h0bWxFcnJvciBcbiAgICAgICAgICA/ICdMb2JieVBNUyBBUEkgZXN0w6EgZGV2b2x2aWVuZG8gSFRNTCBlbiBsdWdhciBkZSBKU09OIC0gcG9zaWJsZSBwcm9ibGVtYSBkZSBJUCBvIGF1dGVudGljYWNpw7NuJyBcbiAgICAgICAgICA6ICdFcnJvciBkZSBjb25leGnDs24gY29uIExvYmJ5UE1TJyxcbiAgICAgICAgZGVidWc6IHtcbiAgICAgICAgICBlcnJvclR5cGU6IGFwaUVycm9yLm5hbWUsXG4gICAgICAgICAgbWVzc2FnZTogYXBpRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBzdWdnZXN0aW9uOiBpc0h0bWxFcnJvciBcbiAgICAgICAgICAgID8gJ1ZlcmlmaWNhIHF1ZSB0dSBJUCBlc3TDoSBhdXRvcml6YWRhIGVuIExvYmJ5UE1TIHkgcXVlIGVsIEFQSSB0b2tlbiBlcyB2w6FsaWRvJ1xuICAgICAgICAgICAgOiAnRW5kcG9pbnQgL2F2YWlsYWJsZS1yb29tcyBmYWlsZWQgLSBjaGVjayBBUEkgY3JlZGVudGlhbHMgYW5kIElQIGF1dGhvcml6YXRpb24nLFxuICAgICAgICAgIGVuZHBvaW50VXNlZDogJy9hdmFpbGFibGUtcm9vbXMnLFxuICAgICAgICAgIGlzSHRtbEVycm9yOiBpc0h0bWxFcnJvcixcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9LCB7IHN0YXR1czogNTAzIH0pO1xuICAgIH1cblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEdlbmVyYWwgYXZhaWxhYmlsaXR5IGVycm9yOicsIGVycm9yKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRXJyb3IgY2hlY2tpbmcgYXZhaWxhYmlsaXR5JyxcbiAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2VcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJsb2JieVBNU0NsaWVudCIsInNlbnRXaGF0c0FwcFNldCIsIlNldCIsIlBPU1QiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsImJvZHkiLCJqc29uIiwiY2hlY2tJbiIsImNoZWNrT3V0IiwiZ3Vlc3RzIiwiYXZhaWxhYmlsaXR5RGF0YSIsImdldEF2YWlsYWJsZVJvb21zIiwic3RhcnRfZGF0ZSIsImVuZF9kYXRlIiwibGVuZ3RoIiwiSlNPTiIsInN0cmluZ2lmeSIsInJvb21UeXBlcyIsInJvb21UeXBlSWQiLCJyb29tVHlwZU5hbWUiLCJtYXhHdWVzdHMiLCJjYXRlZ29yaWVzIiwiYXZhaWxhYmxlUm9vbXNCeURheSIsInByaWNlcyIsImNoZWNrSW5EYXRlIiwiRGF0ZSIsImNoZWNrT3V0RGF0ZSIsIm5pZ2h0cyIsIk1hdGgiLCJjZWlsIiwiZ2V0VGltZSIsImluZGl2aWR1YWxDYXRlZ29yaWVzIiwiZGF5c1RvUHJvY2VzcyIsIm1pbiIsInNsaWNlIiwiZm9yRWFjaCIsImRheURhdGEiLCJkYXlJbmRleCIsImRhdGUiLCJBcnJheSIsImlzQXJyYXkiLCJjYXRlZ29yeSIsImNhdEluZGV4IiwiY2F0ZWdvcnlfaWQiLCJuYW1lIiwiYXZhaWxhYmxlX3Jvb21zIiwiY2F0ZWdvcnlOYW1lIiwidG9Mb3dlckNhc2UiLCJzaW5nbGVQcmljZSIsImZpbmQiLCJwIiwicGVvcGxlIiwidmFsdWUiLCJhdmFpbGFibGVCeURheSIsImZpbGwiLCJyb29tVHlwZSIsInB1c2giLCJPYmplY3QiLCJrZXlzIiwicm9vbVR5cGVLZXkiLCJ0b3RhbEF2YWlsYWJsZUZvckFsbERheXMiLCJlbnRyaWVzIiwiY2F0ZWdvcnlEYXRhIiwibWluQXZhaWxhYmxlRm9yQ2F0ZWdvcnkiLCJqb2luIiwiYXZhaWxhYmxlUm9vbXMiLCJrZXkiLCJmaW5hbFByaWNlIiwiY2FzYVBsYXlhUHJpY2UiLCJzb3J0ZWRQcmljZXMiLCJzb3J0IiwiYSIsImIiLCJmbG9vciIsInRvdGFsQXZhaWxhYmxlIiwicHJpY2VQZXJOaWdodCIsInJlYWxQcmljZSIsInByaWNlU291cmNlIiwiYXZhaWxhYmxlIiwiZGVidWciLCJvcmlnaW5hbENhdGVnb3J5Iiwic291cmNlIiwiYWxsQ2F0ZWdvcmllcyIsIm1hcCIsImMiLCJhbGxQcmljZXMiLCJtaW5BdmFpbGFibGVSb29tcyIsInJvb20iLCJpbmRleCIsInN1Y2Nlc3MiLCJlcnJvciIsInRvdGFsRGF5c1Byb2Nlc3NlZCIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJyZXN1bHQiLCJ0b3RhbERheXNGcm9tQVBJIiwiZW5kcG9pbnRVc2VkIiwicHJpY2VBbmFseXNpcyIsInIiLCJwcmljZSIsImFwaUVycm9yIiwic3RhY2siLCJyZXNwb25zZSIsImRhdGEiLCJpc0h0bWxFcnJvciIsImluY2x1ZGVzIiwiZXJyb3JUeXBlIiwic3VnZ2VzdGlvbiIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwiZGV0YWlscyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/availability/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/lobbypms.ts":
/*!*************************!*\
  !*** ./lib/lobbypms.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LobbyPMSClient: () => (/* binding */ LobbyPMSClient),\n/* harmony export */   lobbyPMSClient: () => (/* binding */ lobbyPMSClient)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n\n// LobbyPMS API Configuration - REAL CREDENTIALS\nconst LOBBYPMS_BASE_URL = process.env.LOBBYPMS_API_URL || \"https://api.lobbypms.com/api/v1\";\nconst LOBBYPMS_API_TOKEN = process.env.LOBBYPMS_API_KEY || \"JNjeoLeXxTHFQSwUPQCgwBnCZktRVv7pfQ48uz2tyoNu6K9dW6D2US1cN9Mu\";\nclass LobbyPMSClient {\n    constructor(baseURL = LOBBYPMS_BASE_URL, apiToken = LOBBYPMS_API_TOKEN){\n        this.baseURL = baseURL;\n        this.apiToken = apiToken;\n    }\n    buildURL(endpoint, additionalParams) {\n        // Remove leading slash from endpoint if present to avoid replacing the entire path\n        const cleanEndpoint = endpoint.startsWith(\"/\") ? endpoint.slice(1) : endpoint;\n        // Ensure baseURL ends with slash for proper concatenation\n        const baseUrl = this.baseURL.endsWith(\"/\") ? this.baseURL : this.baseURL + \"/\";\n        const url = new URL(cleanEndpoint, baseUrl);\n        url.searchParams.set(\"api_token\", this.apiToken);\n        if (additionalParams) {\n            Object.entries(additionalParams).forEach(([key, value])=>{\n                url.searchParams.set(key, value);\n            });\n        }\n        console.log(\"\\uD83D\\uDD27 URL BUILD DEBUG:\", {\n            originalEndpoint: endpoint,\n            cleanEndpoint: cleanEndpoint,\n            baseUrl: baseUrl,\n            finalUrl: url.toString()\n        });\n        return url.toString();\n    }\n    /**\n   * Get available rooms\n   */ async getRooms(params) {\n        try {\n            const finalUrl = this.buildURL(\"/rooms\", params);\n            console.log(\"\\uD83D\\uDD0D ===== URL CONSTRUCTION ANALYSIS =====\");\n            console.log(\"\\uD83D\\uDD0D Base URL:\", this.baseURL);\n            console.log(\"\\uD83D\\uDD0D API Token:\", this.apiToken);\n            console.log(\"\\uD83D\\uDD0D Endpoint:\", \"/rooms\");\n            console.log(\"\\uD83D\\uDD0D Params:\", params);\n            console.log(\"\\uD83D\\uDD0D Final constructed URL:\", finalUrl);\n            console.log(\"\\uD83D\\uDD0D ===== COMPARISON =====\");\n            console.log(\"\\uD83D\\uDD0D Working Postman URL: https://api.lobbypms.com/api/v1/rooms?api_token=JNjeoLeXxTHFQSwUPQCgwBnCZktRVv7pfQ48uz2tyoNu6K9dW6D2US1cN9Mu\");\n            console.log(\"\\uD83D\\uDD0D App constructed URL:\", finalUrl);\n            console.log(\"\\uD83D\\uDD0D URLs match:\", finalUrl === \"https://api.lobbypms.com/api/v1/rooms?api_token=JNjeoLeXxTHFQSwUPQCgwBnCZktRVv7pfQ48uz2tyoNu6K9dW6D2US1cN9Mu\");\n            // First try with params, then without if no results\n            let response;\n            let responseData;\n            try {\n                console.log(\"\\uD83D\\uDE80 Making request to:\", finalUrl);\n                response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(finalUrl, {\n                    timeout: 10000,\n                    headers: {\n                        \"Accept\": \"application/json\",\n                        \"Content-Type\": \"application/json\",\n                        \"User-Agent\": \"SurfCampSantaTeresa/1.0\"\n                    }\n                });\n                responseData = response.data;\n                console.log(\"\\uD83D\\uDCE5 Response received - Status:\", response.status);\n                console.log(\"\\uD83D\\uDCE5 Response Content-Type:\", response.headers[\"content-type\"]);\n                console.log(\"\\uD83D\\uDCE5 Response Data Type:\", typeof responseData);\n                console.log(\"\\uD83D\\uDCE5 Response Size:\", JSON.stringify(responseData).length, \"characters\");\n                // Check if response is HTML\n                if (typeof responseData === \"string\" && responseData.includes(\"<!doctype html>\")) {\n                    console.log(\"\\uD83D\\uDEA8 ===== CRITICAL ERROR: HTML RESPONSE =====\");\n                    console.log(\"\\uD83D\\uDEA8 Expected: JSON data\");\n                    console.log(\"\\uD83D\\uDEA8 Received: HTML page\");\n                    console.log(\"\\uD83D\\uDEA8 This means the API endpoint is not working correctly\");\n                    console.log(\"\\uD83D\\uDEA8 Possible causes:\");\n                    console.log(\"   1. Wrong API endpoint URL\");\n                    console.log(\"   2. Invalid API token\");\n                    console.log(\"   3. API server routing issue\");\n                    console.log(\"   4. Authentication/authorization problem\");\n                    console.log(\"\\uD83D\\uDEA8 HTML content (first 300 chars):\", responseData.substring(0, 300));\n                    // Extract title from HTML for debugging\n                    const titleMatch = responseData.match(/<title>(.*?)<\\/title>/);\n                    if (titleMatch) {\n                        console.log(\"\\uD83D\\uDEA8 HTML Page Title:\", titleMatch[1]);\n                    }\n                    throw new Error(\"LobbyPMS API returned HTML instead of JSON. This indicates an API endpoint or authentication issue.\");\n                }\n                console.log(\"✅ Valid JSON response received\");\n            } catch (requestError) {\n                console.error(\"❌ Request failed:\", {\n                    message: requestError.message,\n                    status: requestError.response?.status,\n                    statusText: requestError.response?.statusText,\n                    url: finalUrl,\n                    responseType: typeof requestError.response?.data,\n                    responseLength: requestError.response?.data?.length || 0\n                });\n                // If we had parameters, try without them as fallback\n                if (params && Object.keys(params).length > 0) {\n                    console.log(\"\\uD83D\\uDD04 Trying without parameters as fallback...\");\n                    const fallbackUrl = this.buildURL(\"/rooms\");\n                    console.log(\"\\uD83D\\uDD04 Fallback URL:\", fallbackUrl);\n                    response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(fallbackUrl, {\n                        timeout: 10000,\n                        headers: {\n                            \"Accept\": \"application/json\",\n                            \"Content-Type\": \"application/json\",\n                            \"User-Agent\": \"SurfCampSantaTeresa/1.0\"\n                        }\n                    });\n                    responseData = response.data;\n                    console.log(\"\\uD83D\\uDCE5 Fallback response - Status:\", response.status);\n                    console.log(\"\\uD83D\\uDCE5 Fallback response - Content-Type:\", response.headers[\"content-type\"]);\n                    console.log(\"\\uD83D\\uDCE5 Fallback response - Data Type:\", typeof responseData);\n                    if (typeof responseData === \"string\" && responseData.includes(\"<!doctype html>\")) {\n                        console.log(\"\\uD83D\\uDEA8 Fallback also returned HTML - API endpoint is definitely broken\");\n                        throw new Error(\"LobbyPMS API consistently returns HTML instead of JSON. API endpoint is not working.\");\n                    }\n                } else {\n                    throw requestError;\n                }\n            }\n            console.log(\"\\uD83D\\uDCE5 LobbyPMS ROOMS API SUMMARY:\");\n            console.log(\"   Status Code:\", response.status);\n            console.log(\"   Content-Type:\", response.headers[\"content-type\"]);\n            console.log(\"   Response Type:\", typeof responseData);\n            console.log(\"   Response Size:\", JSON.stringify(responseData).length, \"characters\");\n            console.log(\"   Has .data property:\", !!(responseData && \"data\" in responseData));\n            console.log(\"   Categories count:\", responseData?.data?.length || 0);\n            console.log(\"   \\uD83D\\uDD0D REQUEST URL:\", this.buildURL(\"/rooms\", params));\n            console.log(\"   \\uD83D\\uDD0D REQUEST PARAMS:\", params);\n            console.log(\"   \\uD83D\\uDD0D API TOKEN (last 8 chars):\", this.apiToken.slice(-8));\n            // Check if we got HTML instead of JSON\n            if (typeof responseData === \"string\" && responseData.includes(\"<!doctype html>\")) {\n                console.log(\"❌ CRITICAL: API returned HTML page instead of JSON data\");\n                console.log(\"❌ This usually means:\");\n                console.log(\"   1. Wrong API endpoint URL\");\n                console.log(\"   2. Invalid API token\");\n                console.log(\"   3. API server is down\");\n                console.log(\"   4. Rate limiting or IP blocking\");\n                console.log(\"❌ HTML Title:\", responseData.match(/<title>(.*?)<\\/title>/)?.[1] || \"No title found\");\n            }\n            // Handle the actual API structure: {data: [categories]}\n            const categories = responseData?.data || [];\n            console.log(\"\\uD83D\\uDCCA Extracted categories:\", categories.length);\n            if (categories.length > 0) {\n                console.log(\"\\uD83D\\uDCCA First category structure:\", JSON.stringify(categories[0], null, 2));\n            }\n            const rooms = [];\n            // Extract rooms from each category\n            categories.forEach((category, index)=>{\n                console.log(`🏠 Processing category ${index + 1}:`, {\n                    id: category.category_id,\n                    name: category.name,\n                    capacity: category.capacity,\n                    quantity: category.quantity,\n                    roomsCount: category.rooms?.length || 0\n                });\n                if (category.rooms && Array.isArray(category.rooms)) {\n                    // Add the category as a room type - NO FALLBACK PRICES\n                    const room = {\n                        id: category.category_id?.toString() || \"\",\n                        name: category.name || \"Unknown Room\",\n                        room_type_id: category.category_id?.toString() || \"\",\n                        room_type_name: category.name || \"Unknown Room\",\n                        available_rooms: category.quantity || 1,\n                        capacity: category.capacity || 2,\n                        price_per_night: undefined,\n                        rate: undefined // NO fallback - use real data only\n                    };\n                    console.log(`✅ Added room:`, room);\n                    rooms.push(room);\n                } else {\n                    console.log(`❌ Category ${category.name} has no valid rooms array`);\n                }\n            });\n            console.log(\"\\uD83C\\uDFAF Final rooms array:\", rooms.length, \"rooms\");\n            return rooms;\n        } catch (error) {\n            console.error(\"❌ LobbyPMS getRooms DETAILED ERROR:\", {\n                message: error.message,\n                status: error.response?.status,\n                statusText: error.response?.statusText,\n                headers: error.response?.headers,\n                data: typeof error.response?.data === \"string\" ? error.response.data.substring(0, 200) : error.response?.data,\n                stack: error.stack,\n                url: this.buildURL(\"/rooms\", params),\n                config: {\n                    baseURL: this.baseURL,\n                    tokenLastChars: this.apiToken.slice(-8),\n                    paramsUsed: params\n                }\n            });\n            // Create specific error message based on the error type\n            let specificError = `LobbyPMS API Error: ${error.message}`;\n            if (error.response?.status === 401) {\n                specificError = \"Error de autenticaci\\xf3n: Token API inv\\xe1lido o expirado\";\n            } else if (error.response?.status === 403) {\n                specificError = \"Error de permisos: No tienes acceso a este recurso\";\n            } else if (error.response?.status === 404) {\n                specificError = \"Error de endpoint: La URL del API no es correcta\";\n            } else if (error.response?.status === 429) {\n                specificError = \"Error de l\\xedmite: Demasiadas solicitudes, intenta m\\xe1s tarde\";\n            } else if (error.response?.status >= 500) {\n                specificError = \"Error del servidor: El servidor de LobbyPMS est\\xe1 experimentando problemas\";\n            } else if (error.code === \"ECONNREFUSED\") {\n                specificError = \"Error de conexi\\xf3n: No se puede conectar al servidor de LobbyPMS\";\n            } else if (error.code === \"ENOTFOUND\") {\n                specificError = \"Error de DNS: No se puede resolver la URL del API\";\n            } else if (error.code === \"ETIMEDOUT\") {\n                specificError = \"Error de timeout: La solicitud tard\\xf3 demasiado tiempo\";\n            }\n            // Enhanced error object\n            const enhancedError = new Error(specificError);\n            enhancedError.originalError = error;\n            enhancedError.statusCode = error.response?.status;\n            enhancedError.apiUrl = this.buildURL(\"/rooms\", params);\n            throw enhancedError;\n        }\n    }\n    /**\n   * Get booking information\n   */ async getBookings(params) {\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(this.buildURL(\"/bookings\", params), {\n                timeout: 10000\n            });\n            return response.data || [];\n        } catch (error) {\n            console.error(\"LobbyPMS getBookings error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Create a new booking\n   */ async createBooking(booking) {\n        try {\n            console.log(\"\\uD83D\\uDE80 ===== LOBBY PMS CREATE BOOKING =====\");\n            console.log(\"\\uD83D\\uDE80 Endpoint: /bookings\");\n            console.log(\"\\uD83D\\uDE80 Booking data:\", JSON.stringify(booking, null, 2));\n            const finalUrl = this.buildURL(\"/bookings\");\n            console.log(\"\\uD83D\\uDE80 Final URL:\", finalUrl);\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(finalUrl, booking, {\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Accept\": \"application/json\",\n                    \"User-Agent\": \"SurfCampSantaTeresa/1.0\"\n                },\n                timeout: 15000\n            });\n            console.log(\"✅ LobbyPMS createBooking successful:\");\n            console.log(\"   Status:\", response.status);\n            console.log(\"   Response:\", JSON.stringify(response.data, null, 2));\n            return response.data;\n        } catch (error) {\n            console.error(\"❌ LobbyPMS createBooking error:\", {\n                message: error.message,\n                status: error.response?.status,\n                statusText: error.response?.statusText,\n                responseType: typeof error.response?.data,\n                responseData: error.response?.data,\n                requestData: booking,\n                url: this.buildURL(\"/bookings\")\n            });\n            // Check if response is HTML (error page)\n            const responseData = error.response?.data;\n            if (typeof responseData === \"string\" && (responseData.includes(\"<!doctype html>\") || responseData.includes(\"<html\") || responseData.includes(\"<!DOCTYPE\"))) {\n                const titleMatch = responseData.match(/<title>(.*?)<\\/title>/i);\n                const title = titleMatch ? titleMatch[1] : \"Unknown HTML page\";\n                console.error(\"\\uD83D\\uDEA8 LobbyPMS createBooking returned HTML page instead of JSON:\");\n                console.error(\"\\uD83D\\uDEA8 Page title:\", title);\n                console.error(\"\\uD83D\\uDEA8 HTML preview:\", responseData.substring(0, 300));\n                throw new Error(`LobbyPMS createBooking API returned HTML page \"${title}\" instead of JSON - possible IP authorization or API token issue`);\n            }\n            throw error;\n        }\n    }\n    /**\n   * Get rates information\n   */ async getRates(params) {\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(this.buildURL(\"/rates\", params), {\n                timeout: 10000\n            });\n            return response.data || [];\n        } catch (error) {\n            console.error(\"LobbyPMS getRates error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Get products/services\n   */ async getProducts() {\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(this.buildURL(\"/products\"), {\n                timeout: 10000\n            });\n            return response.data || [];\n        } catch (error) {\n            console.error(\"LobbyPMS getProducts error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Get clients information\n   */ async getClients(params) {\n        try {\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(this.buildURL(\"/clients\", params), {\n                timeout: 10000\n            });\n            return response.data || [];\n        } catch (error) {\n            console.error(\"LobbyPMS getClients error:\", error);\n            throw error;\n        }\n    }\n    /**\n   * Get room availability, rates and restrictions for specific dates\n   * According to LobbyPMS API documentation: GET /api/v1/available-rooms\n   */ async getAvailableRooms(params) {\n        try {\n            // Convert ISO dates to YYYY-mm-dd format (required by API)\n            const startDate = params.start_date.includes(\"T\") ? params.start_date.split(\"T\")[0] : params.start_date;\n            const endDate = params.end_date.includes(\"T\") ? params.end_date.split(\"T\")[0] : params.end_date;\n            // Build parameters according to API documentation\n            const apiParams = {\n                start_date: startDate,\n                end_date: endDate\n            };\n            // Only add category_id if provided\n            if (params.category_id) {\n                apiParams.category_id = params.category_id;\n            }\n            const finalUrl = this.buildURL(\"/available-rooms\", apiParams);\n            console.log(\"\\uD83D\\uDD0D ===== LOBBY PMS AVAILABLE ROOMS API =====\");\n            console.log(\"\\uD83D\\uDD0D Endpoint: /available-rooms (CORRECT per documentation)\");\n            console.log(\"\\uD83D\\uDD0D Start date:\", startDate);\n            console.log(\"\\uD83D\\uDD0D End date:\", endDate);\n            console.log(\"\\uD83D\\uDD0D Category ID:\", params.category_id || \"All categories\");\n            console.log(\"\\uD83D\\uDD0D Final URL:\", finalUrl);\n            const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].get(finalUrl, {\n                timeout: 15000,\n                headers: {\n                    \"Accept\": \"application/json\",\n                    \"Content-Type\": \"application/json\",\n                    \"User-Agent\": \"SurfCampSantaTeresa/1.0\"\n                }\n            });\n            const responseData = response.data;\n            console.log(\"\\uD83D\\uDCE5 ===== API RESPONSE ANALYSIS =====\");\n            console.log(\"\\uD83D\\uDCE5 Status:\", response.status);\n            console.log(\"\\uD83D\\uDCE5 Content-Type:\", response.headers[\"content-type\"]);\n            console.log(\"\\uD83D\\uDCE5 Response Type:\", typeof responseData);\n            console.log(\"\\uD83D\\uDCE5 Has data property:\", !!(responseData && \"data\" in responseData));\n            console.log(\"\\uD83D\\uDCE5 Data length:\", responseData?.data?.length || 0);\n            // Validate response structure\n            if (!responseData || typeof responseData !== \"object\") {\n                throw new Error(\"Invalid response format from LobbyPMS API\");\n            }\n            // Check if response is HTML (error page)\n            if (typeof responseData === \"string\" && (responseData.includes(\"<!doctype html>\") || responseData.includes(\"<html\") || responseData.includes(\"<!DOCTYPE\"))) {\n                // Extract title from HTML for more specific error\n                const titleMatch = responseData.match(/<title>(.*?)<\\/title>/i);\n                const title = titleMatch ? titleMatch[1] : \"Unknown HTML page\";\n                console.error(\"\\uD83D\\uDEA8 LobbyPMS returned HTML page instead of JSON:\");\n                console.error(\"\\uD83D\\uDEA8 Page title:\", title);\n                console.error(\"\\uD83D\\uDEA8 HTML preview:\", responseData.substring(0, 300));\n                throw new Error(`LobbyPMS API returned HTML page \"${title}\" instead of JSON - possible IP authorization or API token issue`);\n            }\n            console.log(\"✅ Valid JSON response received from LobbyPMS\");\n            // Log response structure for debugging\n            const dataArray = responseData.data || [];\n            console.log(\"\\uD83D\\uDCCA Response summary:\");\n            console.log(\"   \\uD83D\\uDCC5 Days returned:\", dataArray.length);\n            if (dataArray.length > 0) {\n                console.log(\"   \\uD83D\\uDCC5 First day:\", dataArray[0].date);\n                console.log(\"   \\uD83C\\uDFE0 Categories in first day:\", dataArray[0].categories?.length || 0);\n                if (dataArray[0].categories && dataArray[0].categories.length > 0) {\n                    const firstCategory = dataArray[0].categories[0];\n                    console.log(\"   \\uD83C\\uDFE0 First category example:\", {\n                        id: firstCategory.category_id,\n                        name: firstCategory.name,\n                        available_rooms: firstCategory.available_rooms,\n                        prices: firstCategory.prices\n                    });\n                }\n            }\n            return dataArray;\n        } catch (error) {\n            const responseData = error.response?.data;\n            const isHtmlResponse = typeof responseData === \"string\" && (responseData.includes(\"<!doctype html>\") || responseData.includes(\"<html\") || responseData.includes(\"<!DOCTYPE\"));\n            console.error(\"❌ LOBBY PMS AVAILABLE ROOMS ERROR:\", {\n                message: error.message,\n                status: error.response?.status,\n                statusText: error.response?.statusText,\n                responseType: typeof responseData,\n                isHtmlResponse: isHtmlResponse,\n                responsePreview: typeof responseData === \"string\" ? responseData.substring(0, 300) : responseData,\n                requestUrl: this.buildURL(\"/available-rooms\", {\n                    start_date: params.start_date.includes(\"T\") ? params.start_date.split(\"T\")[0] : params.start_date,\n                    end_date: params.end_date.includes(\"T\") ? params.end_date.split(\"T\")[0] : params.end_date,\n                    ...params.category_id && {\n                        category_id: params.category_id\n                    }\n                }),\n                apiToken: this.apiToken.slice(-8)\n            });\n            // Enhanced error message based on response type\n            let errorMessage = `LobbyPMS available rooms API failed: ${error.message}`;\n            if (isHtmlResponse) {\n                const titleMatch = responseData.match(/<title>(.*?)<\\/title>/i);\n                const title = titleMatch ? titleMatch[1] : \"Unknown page\";\n                errorMessage = `LobbyPMS API returned HTML page \"${title}\" instead of JSON - check IP authorization and API token`;\n            }\n            throw new Error(errorMessage);\n        }\n    }\n    /**\n   * Check if API is configured and working\n   */ isConfigured() {\n        // Check if we have a valid API token that's not a placeholder\n        const hasValidToken = !!(this.apiToken && this.apiToken !== \"your_api_token_here\" && this.apiToken.length > 20 && !this.apiToken.includes(\"placeholder\"));\n        // Check if we have a valid base URL\n        const hasValidURL = !!(this.baseURL && this.baseURL !== \"https://your-api-url.com\" && !this.baseURL.includes(\"placeholder\") && this.baseURL.includes(\"lobbypms.com\"));\n        console.log(\"\\uD83D\\uDD27 LobbyPMS Configuration Check:\", {\n            hasValidToken,\n            hasValidURL,\n            tokenLength: this.apiToken?.length || 0,\n            baseURL: this.baseURL,\n            isConfigured: hasValidToken && hasValidURL\n        });\n        return hasValidToken && hasValidURL;\n    }\n    /**\n   * Test API connectivity\n   */ async testConnection() {\n        try {\n            // Use the correct endpoint for testing\n            await this.getAvailableRooms({\n                start_date: \"2025-01-01\",\n                end_date: \"2025-01-02\"\n            });\n            return true;\n        } catch (error) {\n            return false;\n        }\n    }\n}\n// Export a default instance\nconst lobbyPMSClient = new LobbyPMSClient();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUM5RCxNQUFNQyxnQkFBZ0IsQ0FBQyxDQUFFLEtBQUksQ0FBQ3ZHLFFBQVEsSUFDaEIsSUFBSSxDQUFDQSxRQUFRLEtBQUsseUJBQ2xCLElBQUksQ0FBQ0EsUUFBUSxDQUFDa0MsTUFBTSxHQUFHLE1BQ3ZCLENBQUMsSUFBSSxDQUFDbEMsUUFBUSxDQUFDbUMsUUFBUSxDQUFDLGNBQWE7UUFFM0Qsb0NBQW9DO1FBQ3BDLE1BQU1xRSxjQUFjLENBQUMsQ0FBRSxLQUFJLENBQUN6RyxPQUFPLElBQ2hCLElBQUksQ0FBQ0EsT0FBTyxLQUFLLDhCQUNqQixDQUFDLElBQUksQ0FBQ0EsT0FBTyxDQUFDb0MsUUFBUSxDQUFDLGtCQUN2QixJQUFJLENBQUNwQyxPQUFPLENBQUNvQyxRQUFRLENBQUMsZUFBYztRQUV2RGpCLFFBQVFDLEdBQUcsQ0FBQyw4Q0FBb0M7WUFDOUNvRjtZQUNBQztZQUNBQyxhQUFhLElBQUksQ0FBQ3pHLFFBQVEsRUFBRWtDLFVBQVU7WUFDdENuQyxTQUFTLElBQUksQ0FBQ0EsT0FBTztZQUNyQnVHLGNBQWNDLGlCQUFpQkM7UUFDakM7UUFFQSxPQUFPRCxpQkFBaUJDO0lBQzFCO0lBRUE7O0dBRUMsR0FDRCxNQUFNRSxpQkFBbUM7UUFDdkMsSUFBSTtZQUNGLHVDQUF1QztZQUN2QyxNQUFNLElBQUksQ0FBQ25CLGlCQUFpQixDQUFDO2dCQUMzQkUsWUFBWTtnQkFDWkcsVUFBVTtZQUNaO1lBQ0EsT0FBTztRQUNULEVBQUUsT0FBT25ELE9BQU87WUFDZCxPQUFPO1FBQ1Q7SUFDRjtBQUNGO0FBRUEsNEJBQTRCO0FBQ3JCLE1BQU1rRSxpQkFBaUIsSUFBSTlHLGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL3N1cmZjYW1wLWJvb2tpbmctc3lzdGVtLy4vbGliL2xvYmJ5cG1zLnRzPzIwZjMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF4aW9zLCB7IEF4aW9zUmVzcG9uc2UgfSBmcm9tICdheGlvcyc7XG5pbXBvcnQgeyBMb2JieVBNU0Jvb2tpbmcgfSBmcm9tICdAL3R5cGVzJztcblxuLy8gTG9iYnlQTVMgQVBJIENvbmZpZ3VyYXRpb24gLSBSRUFMIENSRURFTlRJQUxTXG5jb25zdCBMT0JCWVBNU19CQVNFX1VSTCA9IHByb2Nlc3MuZW52LkxPQkJZUE1TX0FQSV9VUkwgfHwgJ2h0dHBzOi8vYXBpLmxvYmJ5cG1zLmNvbS9hcGkvdjEnO1xuY29uc3QgTE9CQllQTVNfQVBJX1RPS0VOID0gcHJvY2Vzcy5lbnYuTE9CQllQTVNfQVBJX0tFWSB8fCAnSk5qZW9MZVh4VEhGUVN3VVBRQ2d3Qm5DWmt0UlZ2N3BmUTQ4dXoydHlvTnU2SzlkVzZEMlVTMWNOOU11JztcblxuZXhwb3J0IGludGVyZmFjZSBMb2JieVBNU1Jvb20ge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJvb21fdHlwZV9pZD86IHN0cmluZztcbiAgcm9vbV90eXBlX25hbWU/OiBzdHJpbmc7XG4gIGF2YWlsYWJsZV9yb29tcz86IG51bWJlcjtcbiAgcHJpY2VfcGVyX25pZ2h0PzogbnVtYmVyOyAvLyBNYWRlIG9wdGlvbmFsIGluc3RlYWQgb2YgcmVxdWlyaW5nIG51bWJlclxuICByYXRlPzogbnVtYmVyOyAvLyBNYWRlIG9wdGlvbmFsIGluc3RlYWQgb2YgcmVxdWlyaW5nIG51bWJlclxuICBjYXBhY2l0eT86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIExvYmJ5UE1TQ2xpZW50IHtcbiAgcHJpdmF0ZSBiYXNlVVJMOiBzdHJpbmc7XG4gIHByaXZhdGUgYXBpVG9rZW46IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihiYXNlVVJMID0gTE9CQllQTVNfQkFTRV9VUkwsIGFwaVRva2VuID0gTE9CQllQTVNfQVBJX1RPS0VOKSB7XG4gICAgdGhpcy5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICB0aGlzLmFwaVRva2VuID0gYXBpVG9rZW47XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkVVJMKGVuZHBvaW50OiBzdHJpbmcsIGFkZGl0aW9uYWxQYXJhbXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KTogc3RyaW5nIHtcbiAgICAvLyBSZW1vdmUgbGVhZGluZyBzbGFzaCBmcm9tIGVuZHBvaW50IGlmIHByZXNlbnQgdG8gYXZvaWQgcmVwbGFjaW5nIHRoZSBlbnRpcmUgcGF0aFxuICAgIGNvbnN0IGNsZWFuRW5kcG9pbnQgPSBlbmRwb2ludC5zdGFydHNXaXRoKCcvJykgPyBlbmRwb2ludC5zbGljZSgxKSA6IGVuZHBvaW50O1xuICAgIFxuICAgIC8vIEVuc3VyZSBiYXNlVVJMIGVuZHMgd2l0aCBzbGFzaCBmb3IgcHJvcGVyIGNvbmNhdGVuYXRpb25cbiAgICBjb25zdCBiYXNlVXJsID0gdGhpcy5iYXNlVVJMLmVuZHNXaXRoKCcvJykgPyB0aGlzLmJhc2VVUkwgOiB0aGlzLmJhc2VVUkwgKyAnLyc7XG4gICAgXG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChjbGVhbkVuZHBvaW50LCBiYXNlVXJsKTtcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnYXBpX3Rva2VuJywgdGhpcy5hcGlUb2tlbik7XG4gICAgXG4gICAgaWYgKGFkZGl0aW9uYWxQYXJhbXMpIHtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGFkZGl0aW9uYWxQYXJhbXMpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChrZXksIHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UpyBVUkwgQlVJTEQgREVCVUc6Jywge1xuICAgICAgb3JpZ2luYWxFbmRwb2ludDogZW5kcG9pbnQsXG4gICAgICBjbGVhbkVuZHBvaW50OiBjbGVhbkVuZHBvaW50LFxuICAgICAgYmFzZVVybDogYmFzZVVybCxcbiAgICAgIGZpbmFsVXJsOiB1cmwudG9TdHJpbmcoKVxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiB1cmwudG9TdHJpbmcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYXZhaWxhYmxlIHJvb21zXG4gICAqL1xuICBhc3luYyBnZXRSb29tcyhwYXJhbXM/OiB7XG4gICAgYXJyaXZhbF9kYXRlPzogc3RyaW5nO1xuICAgIGRlcGFydHVyZV9kYXRlPzogc3RyaW5nO1xuICAgIGd1ZXN0X2NvdW50Pzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxMb2JieVBNU1Jvb21bXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaW5hbFVybCA9IHRoaXMuYnVpbGRVUkwoJy9yb29tcycsIHBhcmFtcyk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNID09PT09IFVSTCBDT05TVFJVQ1RJT04gQU5BTFlTSVMgPT09PT0nKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEJhc2UgVVJMOicsIHRoaXMuYmFzZVVSTCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBBUEkgVG9rZW46JywgdGhpcy5hcGlUb2tlbik7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBFbmRwb2ludDonLCAnL3Jvb21zJyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBQYXJhbXM6JywgcGFyYW1zKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEZpbmFsIGNvbnN0cnVjdGVkIFVSTDonLCBmaW5hbFVybCk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSA9PT09PSBDT01QQVJJU09OID09PT09Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBXb3JraW5nIFBvc3RtYW4gVVJMOiBodHRwczovL2FwaS5sb2JieXBtcy5jb20vYXBpL3YxL3Jvb21zP2FwaV90b2tlbj1KTmplb0xlWHhUSEZRU3dVUFFDZ3dCbkNaa3RSVnY3cGZRNDh1ejJ0eW9OdTZLOWRXNkQyVVMxY045TXUnKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEFwcCBjb25zdHJ1Y3RlZCBVUkw6JywgZmluYWxVcmwpO1xuICAgICAgY29uc29sZS5sb2coJ/CflI0gVVJMcyBtYXRjaDonLCBmaW5hbFVybCA9PT0gJ2h0dHBzOi8vYXBpLmxvYmJ5cG1zLmNvbS9hcGkvdjEvcm9vbXM/YXBpX3Rva2VuPUpOamVvTGVYeFRIRlFTd1VQUUNnd0JuQ1prdFJWdjdwZlE0OHV6MnR5b051Nks5ZFc2RDJVUzFjTjlNdScpO1xuICAgICAgXG4gICAgICAvLyBGaXJzdCB0cnkgd2l0aCBwYXJhbXMsIHRoZW4gd2l0aG91dCBpZiBubyByZXN1bHRzXG4gICAgICBsZXQgcmVzcG9uc2U6IEF4aW9zUmVzcG9uc2U8e2RhdGE6IGFueVtdfT47XG4gICAgICBsZXQgcmVzcG9uc2VEYXRhO1xuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+agCBNYWtpbmcgcmVxdWVzdCB0bzonLCBmaW5hbFVybCk7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KGZpbmFsVXJsLCB7IFxuICAgICAgICAgICAgICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ1VzZXItQWdlbnQnOiAnU3VyZkNhbXBTYW50YVRlcmVzYS8xLjAnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgUmVzcG9uc2UgcmVjZWl2ZWQgLSBTdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgUmVzcG9uc2UgQ29udGVudC1UeXBlOicsIHJlc3BvbnNlLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddKTtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgUmVzcG9uc2UgRGF0YSBUeXBlOicsIHR5cGVvZiByZXNwb25zZURhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZygn8J+TpSBSZXNwb25zZSBTaXplOicsIEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlRGF0YSkubGVuZ3RoLCAnY2hhcmFjdGVycycpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgSFRNTFxuICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ3N0cmluZycgJiYgKHJlc3BvbnNlRGF0YSBhcyBzdHJpbmcpLmluY2x1ZGVzKCc8IWRvY3R5cGUgaHRtbD4nKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5qoID09PT09IENSSVRJQ0FMIEVSUk9SOiBIVE1MIFJFU1BPTlNFID09PT09Jyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CfmqggRXhwZWN0ZWQ6IEpTT04gZGF0YScpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5qoIFJlY2VpdmVkOiBIVE1MIHBhZ2UnKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+aqCBUaGlzIG1lYW5zIHRoZSBBUEkgZW5kcG9pbnQgaXMgbm90IHdvcmtpbmcgY29ycmVjdGx5Jyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/CfmqggUG9zc2libGUgY2F1c2VzOicpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCcgICAxLiBXcm9uZyBBUEkgZW5kcG9pbnQgVVJMJyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJyAgIDIuIEludmFsaWQgQVBJIHRva2VuJyk7XG4gICAgICAgICAgY29uc29sZS5sb2coJyAgIDMuIEFQSSBzZXJ2ZXIgcm91dGluZyBpc3N1ZScpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCcgICA0LiBBdXRoZW50aWNhdGlvbi9hdXRob3JpemF0aW9uIHByb2JsZW0nKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+aqCBIVE1MIGNvbnRlbnQgKGZpcnN0IDMwMCBjaGFycyk6JywgKHJlc3BvbnNlRGF0YSBhcyBzdHJpbmcpLnN1YnN0cmluZygwLCAzMDApKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBFeHRyYWN0IHRpdGxlIGZyb20gSFRNTCBmb3IgZGVidWdnaW5nXG4gICAgICAgICAgY29uc3QgdGl0bGVNYXRjaCA9IChyZXNwb25zZURhdGEgYXMgc3RyaW5nKS5tYXRjaCgvPHRpdGxlPiguKj8pPFxcL3RpdGxlPi8pO1xuICAgICAgICAgIGlmICh0aXRsZU1hdGNoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygn8J+aqCBIVE1MIFBhZ2UgVGl0bGU6JywgdGl0bGVNYXRjaFsxXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTG9iYnlQTVMgQVBJIHJldHVybmVkIEhUTUwgaW5zdGVhZCBvZiBKU09OLiBUaGlzIGluZGljYXRlcyBhbiBBUEkgZW5kcG9pbnQgb3IgYXV0aGVudGljYXRpb24gaXNzdWUuJyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgVmFsaWQgSlNPTiByZXNwb25zZSByZWNlaXZlZCcpO1xuICAgICAgICBcbiAgICAgIH0gY2F0Y2ggKHJlcXVlc3RFcnJvcjogYW55KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBSZXF1ZXN0IGZhaWxlZDonLCB7XG4gICAgICAgICAgbWVzc2FnZTogcmVxdWVzdEVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgc3RhdHVzOiByZXF1ZXN0RXJyb3IucmVzcG9uc2U/LnN0YXR1cyxcbiAgICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0RXJyb3IucmVzcG9uc2U/LnN0YXR1c1RleHQsXG4gICAgICAgICAgdXJsOiBmaW5hbFVybCxcbiAgICAgICAgICByZXNwb25zZVR5cGU6IHR5cGVvZiByZXF1ZXN0RXJyb3IucmVzcG9uc2U/LmRhdGEsXG4gICAgICAgICAgcmVzcG9uc2VMZW5ndGg6IHJlcXVlc3RFcnJvci5yZXNwb25zZT8uZGF0YT8ubGVuZ3RoIHx8IDBcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBJZiB3ZSBoYWQgcGFyYW1ldGVycywgdHJ5IHdpdGhvdXQgdGhlbSBhcyBmYWxsYmFja1xuICAgICAgICBpZiAocGFyYW1zICYmIE9iamVjdC5rZXlzKHBhcmFtcykubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFRyeWluZyB3aXRob3V0IHBhcmFtZXRlcnMgYXMgZmFsbGJhY2suLi4nKTtcbiAgICAgICAgICBjb25zdCBmYWxsYmFja1VybCA9IHRoaXMuYnVpbGRVUkwoJy9yb29tcycpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEZhbGxiYWNrIFVSTDonLCBmYWxsYmFja1VybCk7XG4gICAgICAgICAgXG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoZmFsbGJhY2tVcmwsIHsgXG4gICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogMTAwMDAsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdTdXJmQ2FtcFNhbnRhVGVyZXNhLzEuMCdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgRmFsbGJhY2sgcmVzcG9uc2UgLSBTdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+TpSBGYWxsYmFjayByZXNwb25zZSAtIENvbnRlbnQtVHlwZTonLCByZXNwb25zZS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSk7XG4gICAgICAgICAgY29uc29sZS5sb2coJ/Cfk6UgRmFsbGJhY2sgcmVzcG9uc2UgLSBEYXRhIFR5cGU6JywgdHlwZW9mIHJlc3BvbnNlRGF0YSk7XG4gICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ3N0cmluZycgJiYgKHJlc3BvbnNlRGF0YSBhcyBzdHJpbmcpLmluY2x1ZGVzKCc8IWRvY3R5cGUgaHRtbD4nKSkge1xuICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5qoIEZhbGxiYWNrIGFsc28gcmV0dXJuZWQgSFRNTCAtIEFQSSBlbmRwb2ludCBpcyBkZWZpbml0ZWx5IGJyb2tlbicpO1xuICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTG9iYnlQTVMgQVBJIGNvbnNpc3RlbnRseSByZXR1cm5zIEhUTUwgaW5zdGVhZCBvZiBKU09OLiBBUEkgZW5kcG9pbnQgaXMgbm90IHdvcmtpbmcuJyk7XG4gICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aHJvdyByZXF1ZXN0RXJyb3I7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/Cfk6UgTG9iYnlQTVMgUk9PTVMgQVBJIFNVTU1BUlk6Jyk7XG4gICAgICBjb25zb2xlLmxvZygnICAgU3RhdHVzIENvZGU6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBDb250ZW50LVR5cGU6JywgcmVzcG9uc2UuaGVhZGVyc1snY29udGVudC10eXBlJ10pO1xuICAgICAgY29uc29sZS5sb2coJyAgIFJlc3BvbnNlIFR5cGU6JywgdHlwZW9mIHJlc3BvbnNlRGF0YSk7XG4gICAgICBjb25zb2xlLmxvZygnICAgUmVzcG9uc2UgU2l6ZTonLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZURhdGEpLmxlbmd0aCwgJ2NoYXJhY3RlcnMnKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBIYXMgLmRhdGEgcHJvcGVydHk6JywgISEocmVzcG9uc2VEYXRhICYmICdkYXRhJyBpbiByZXNwb25zZURhdGEpKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBDYXRlZ29yaWVzIGNvdW50OicsIHJlc3BvbnNlRGF0YT8uZGF0YT8ubGVuZ3RoIHx8IDApO1xuICAgICAgY29uc29sZS5sb2coJyAgIPCflI0gUkVRVUVTVCBVUkw6JywgdGhpcy5idWlsZFVSTCgnL3Jvb21zJywgcGFyYW1zKSk7XG4gICAgICBjb25zb2xlLmxvZygnICAg8J+UjSBSRVFVRVNUIFBBUkFNUzonLCBwYXJhbXMpO1xuICAgICAgY29uc29sZS5sb2coJyAgIPCflI0gQVBJIFRPS0VOIChsYXN0IDggY2hhcnMpOicsIHRoaXMuYXBpVG9rZW4uc2xpY2UoLTgpKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgd2UgZ290IEhUTUwgaW5zdGVhZCBvZiBKU09OXG4gICAgICBpZiAodHlwZW9mIHJlc3BvbnNlRGF0YSA9PT0gJ3N0cmluZycgJiYgKHJlc3BvbnNlRGF0YSBhcyBzdHJpbmcpLmluY2x1ZGVzKCc8IWRvY3R5cGUgaHRtbD4nKSkge1xuICAgICAgICBjb25zb2xlLmxvZygn4p2MIENSSVRJQ0FMOiBBUEkgcmV0dXJuZWQgSFRNTCBwYWdlIGluc3RlYWQgb2YgSlNPTiBkYXRhJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinYwgVGhpcyB1c3VhbGx5IG1lYW5zOicpO1xuICAgICAgICBjb25zb2xlLmxvZygnICAgMS4gV3JvbmcgQVBJIGVuZHBvaW50IFVSTCcpO1xuICAgICAgICBjb25zb2xlLmxvZygnICAgMi4gSW52YWxpZCBBUEkgdG9rZW4nKTtcbiAgICAgICAgY29uc29sZS5sb2coJyAgIDMuIEFQSSBzZXJ2ZXIgaXMgZG93bicpO1xuICAgICAgICBjb25zb2xlLmxvZygnICAgNC4gUmF0ZSBsaW1pdGluZyBvciBJUCBibG9ja2luZycpO1xuICAgICAgICBjb25zb2xlLmxvZygn4p2MIEhUTUwgVGl0bGU6JywgKHJlc3BvbnNlRGF0YSBhcyBzdHJpbmcpLm1hdGNoKC88dGl0bGU+KC4qPyk8XFwvdGl0bGU+Lyk/LlsxXSB8fCAnTm8gdGl0bGUgZm91bmQnKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIHRoZSBhY3R1YWwgQVBJIHN0cnVjdHVyZToge2RhdGE6IFtjYXRlZ29yaWVzXX1cbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSByZXNwb25zZURhdGE/LmRhdGEgfHwgW107XG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBFeHRyYWN0ZWQgY2F0ZWdvcmllczonLCBjYXRlZ29yaWVzLmxlbmd0aCk7XG4gICAgICBcbiAgICAgIGlmIChjYXRlZ29yaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS5sb2coJ/Cfk4ogRmlyc3QgY2F0ZWdvcnkgc3RydWN0dXJlOicsIEpTT04uc3RyaW5naWZ5KGNhdGVnb3JpZXNbMF0sIG51bGwsIDIpKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3Qgcm9vbXM6IExvYmJ5UE1TUm9vbVtdID0gW107XG4gICAgICBcbiAgICAgIC8vIEV4dHJhY3Qgcm9vbXMgZnJvbSBlYWNoIGNhdGVnb3J5XG4gICAgICBjYXRlZ29yaWVzLmZvckVhY2goKGNhdGVnb3J5OiBhbnksIGluZGV4OiBudW1iZXIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYPCfj6AgUHJvY2Vzc2luZyBjYXRlZ29yeSAke2luZGV4ICsgMX06YCwge1xuICAgICAgICAgIGlkOiBjYXRlZ29yeS5jYXRlZ29yeV9pZCxcbiAgICAgICAgICBuYW1lOiBjYXRlZ29yeS5uYW1lLFxuICAgICAgICAgIGNhcGFjaXR5OiBjYXRlZ29yeS5jYXBhY2l0eSxcbiAgICAgICAgICBxdWFudGl0eTogY2F0ZWdvcnkucXVhbnRpdHksXG4gICAgICAgICAgcm9vbXNDb3VudDogY2F0ZWdvcnkucm9vbXM/Lmxlbmd0aCB8fCAwXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKGNhdGVnb3J5LnJvb21zICYmIEFycmF5LmlzQXJyYXkoY2F0ZWdvcnkucm9vbXMpKSB7XG4gICAgICAgICAgLy8gQWRkIHRoZSBjYXRlZ29yeSBhcyBhIHJvb20gdHlwZSAtIE5PIEZBTExCQUNLIFBSSUNFU1xuICAgICAgICAgIGNvbnN0IHJvb20gPSB7XG4gICAgICAgICAgICBpZDogY2F0ZWdvcnkuY2F0ZWdvcnlfaWQ/LnRvU3RyaW5nKCkgfHwgJycsXG4gICAgICAgICAgICBuYW1lOiBjYXRlZ29yeS5uYW1lIHx8ICdVbmtub3duIFJvb20nLFxuICAgICAgICAgICAgcm9vbV90eXBlX2lkOiBjYXRlZ29yeS5jYXRlZ29yeV9pZD8udG9TdHJpbmcoKSB8fCAnJyxcbiAgICAgICAgICAgIHJvb21fdHlwZV9uYW1lOiBjYXRlZ29yeS5uYW1lIHx8ICdVbmtub3duIFJvb20nLFxuICAgICAgICAgICAgYXZhaWxhYmxlX3Jvb21zOiBjYXRlZ29yeS5xdWFudGl0eSB8fCAxLFxuICAgICAgICAgICAgY2FwYWNpdHk6IGNhdGVnb3J5LmNhcGFjaXR5IHx8IDIsXG4gICAgICAgICAgICBwcmljZV9wZXJfbmlnaHQ6IHVuZGVmaW5lZCwgLy8gTk8gZmFsbGJhY2sgLSB1c2UgcmVhbCBkYXRhIG9ubHlcbiAgICAgICAgICAgIHJhdGU6IHVuZGVmaW5lZCAvLyBOTyBmYWxsYmFjayAtIHVzZSByZWFsIGRhdGEgb25seVxuICAgICAgICAgIH07XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc29sZS5sb2coYOKchSBBZGRlZCByb29tOmAsIHJvb20pO1xuICAgICAgICAgIHJvb21zLnB1c2gocm9vbSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYOKdjCBDYXRlZ29yeSAke2NhdGVnb3J5Lm5hbWV9IGhhcyBubyB2YWxpZCByb29tcyBhcnJheWApO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/Cfjq8gRmluYWwgcm9vbXMgYXJyYXk6Jywgcm9vbXMubGVuZ3RoLCAncm9vbXMnKTtcbiAgICAgIHJldHVybiByb29tcztcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgTG9iYnlQTVMgZ2V0Um9vbXMgREVUQUlMRUQgRVJST1I6Jywge1xuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICBzdGF0dXM6IGVycm9yLnJlc3BvbnNlPy5zdGF0dXMsXG4gICAgICAgIHN0YXR1c1RleHQ6IGVycm9yLnJlc3BvbnNlPy5zdGF0dXNUZXh0LFxuICAgICAgICBoZWFkZXJzOiBlcnJvci5yZXNwb25zZT8uaGVhZGVycyxcbiAgICAgICAgZGF0YTogdHlwZW9mIGVycm9yLnJlc3BvbnNlPy5kYXRhID09PSAnc3RyaW5nJyBcbiAgICAgICAgICA/IChlcnJvci5yZXNwb25zZS5kYXRhIGFzIHN0cmluZykuc3Vic3RyaW5nKDAsIDIwMCkgXG4gICAgICAgICAgOiBlcnJvci5yZXNwb25zZT8uZGF0YSxcbiAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrLFxuICAgICAgICB1cmw6IHRoaXMuYnVpbGRVUkwoJy9yb29tcycsIHBhcmFtcyksXG4gICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgIGJhc2VVUkw6IHRoaXMuYmFzZVVSTCxcbiAgICAgICAgICB0b2tlbkxhc3RDaGFyczogdGhpcy5hcGlUb2tlbi5zbGljZSgtOCksXG4gICAgICAgICAgcGFyYW1zVXNlZDogcGFyYW1zXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBDcmVhdGUgc3BlY2lmaWMgZXJyb3IgbWVzc2FnZSBiYXNlZCBvbiB0aGUgZXJyb3IgdHlwZVxuICAgICAgbGV0IHNwZWNpZmljRXJyb3IgPSBgTG9iYnlQTVMgQVBJIEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YDtcbiAgICAgIFxuICAgICAgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIGF1dGVudGljYWNpw7NuOiBUb2tlbiBBUEkgaW52w6FsaWRvIG8gZXhwaXJhZG8nO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5yZXNwb25zZT8uc3RhdHVzID09PSA0MDMpIHtcbiAgICAgICAgc3BlY2lmaWNFcnJvciA9ICdFcnJvciBkZSBwZXJtaXNvczogTm8gdGllbmVzIGFjY2VzbyBhIGVzdGUgcmVjdXJzbyc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQwNCkge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIGVuZHBvaW50OiBMYSBVUkwgZGVsIEFQSSBubyBlcyBjb3JyZWN0YSc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPT09IDQyOSkge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIGzDrW1pdGU6IERlbWFzaWFkYXMgc29saWNpdHVkZXMsIGludGVudGEgbcOhcyB0YXJkZSc7XG4gICAgICB9IGVsc2UgaWYgKGVycm9yLnJlc3BvbnNlPy5zdGF0dXMgPj0gNTAwKSB7XG4gICAgICAgIHNwZWNpZmljRXJyb3IgPSAnRXJyb3IgZGVsIHNlcnZpZG9yOiBFbCBzZXJ2aWRvciBkZSBMb2JieVBNUyBlc3TDoSBleHBlcmltZW50YW5kbyBwcm9ibGVtYXMnO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJykge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIGNvbmV4acOzbjogTm8gc2UgcHVlZGUgY29uZWN0YXIgYWwgc2Vydmlkb3IgZGUgTG9iYnlQTVMnO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnRU5PVEZPVU5EJykge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIEROUzogTm8gc2UgcHVlZGUgcmVzb2x2ZXIgbGEgVVJMIGRlbCBBUEknO1xuICAgICAgfSBlbHNlIGlmIChlcnJvci5jb2RlID09PSAnRVRJTUVET1VUJykge1xuICAgICAgICBzcGVjaWZpY0Vycm9yID0gJ0Vycm9yIGRlIHRpbWVvdXQ6IExhIHNvbGljaXR1ZCB0YXJkw7MgZGVtYXNpYWRvIHRpZW1wbyc7XG4gICAgICB9XG5cbiAgICAgIC8vIEVuaGFuY2VkIGVycm9yIG9iamVjdFxuICAgICAgY29uc3QgZW5oYW5jZWRFcnJvciA9IG5ldyBFcnJvcihzcGVjaWZpY0Vycm9yKTtcbiAgICAgIChlbmhhbmNlZEVycm9yIGFzIGFueSkub3JpZ2luYWxFcnJvciA9IGVycm9yO1xuICAgICAgKGVuaGFuY2VkRXJyb3IgYXMgYW55KS5zdGF0dXNDb2RlID0gZXJyb3IucmVzcG9uc2U/LnN0YXR1cztcbiAgICAgIChlbmhhbmNlZEVycm9yIGFzIGFueSkuYXBpVXJsID0gdGhpcy5idWlsZFVSTCgnL3Jvb21zJywgcGFyYW1zKTtcbiAgICAgIFxuICAgICAgdGhyb3cgZW5oYW5jZWRFcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGJvb2tpbmcgaW5mb3JtYXRpb25cbiAgICovXG4gIGFzeW5jIGdldEJvb2tpbmdzKHBhcmFtcz86IHtcbiAgICBhcnJpdmFsX2RhdGU/OiBzdHJpbmc7XG4gICAgZGVwYXJ0dXJlX2RhdGU/OiBzdHJpbmc7XG4gICAgc3RhdHVzPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxMb2JieVBNU0Jvb2tpbmdbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZTogQXhpb3NSZXNwb25zZTxMb2JieVBNU0Jvb2tpbmdbXT4gPSBhd2FpdCBheGlvcy5nZXQoXG4gICAgICAgIHRoaXMuYnVpbGRVUkwoJy9ib29raW5ncycsIHBhcmFtcyksXG4gICAgICAgIHsgdGltZW91dDogMTAwMDAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhIHx8IFtdO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdMb2JieVBNUyBnZXRCb29raW5ncyBlcnJvcjonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IGJvb2tpbmdcbiAgICovXG4gIGFzeW5jIGNyZWF0ZUJvb2tpbmcoYm9va2luZzogTG9iYnlQTVNCb29raW5nKTogUHJvbWlzZTxMb2JieVBNU0Jvb2tpbmc+IHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/CfmoAgPT09PT0gTE9CQlkgUE1TIENSRUFURSBCT09LSU5HID09PT09Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+agCBFbmRwb2ludDogL2Jvb2tpbmdzJyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+agCBCb29raW5nIGRhdGE6JywgSlNPTi5zdHJpbmdpZnkoYm9va2luZywgbnVsbCwgMikpO1xuICAgICAgXG4gICAgICBjb25zdCBmaW5hbFVybCA9IHRoaXMuYnVpbGRVUkwoJy9ib29raW5ncycpO1xuICAgICAgY29uc29sZS5sb2coJ/CfmoAgRmluYWwgVVJMOicsIGZpbmFsVXJsKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2U6IEF4aW9zUmVzcG9uc2U8TG9iYnlQTVNCb29raW5nPiA9IGF3YWl0IGF4aW9zLnBvc3QoXG4gICAgICAgIGZpbmFsVXJsLFxuICAgICAgICBib29raW5nLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczogeyBcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnU3VyZkNhbXBTYW50YVRlcmVzYS8xLjAnXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0aW1lb3V0OiAxNTAwMFxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygn4pyFIExvYmJ5UE1TIGNyZWF0ZUJvb2tpbmcgc3VjY2Vzc2Z1bDonKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBTdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCcgICBSZXNwb25zZTonLCBKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhLCBudWxsLCAyKSk7XG4gICAgICBcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBMb2JieVBNUyBjcmVhdGVCb29raW5nIGVycm9yOicsIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgc3RhdHVzOiBlcnJvci5yZXNwb25zZT8uc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiBlcnJvci5yZXNwb25zZT8uc3RhdHVzVGV4dCxcbiAgICAgICAgcmVzcG9uc2VUeXBlOiB0eXBlb2YgZXJyb3IucmVzcG9uc2U/LmRhdGEsXG4gICAgICAgIHJlc3BvbnNlRGF0YTogZXJyb3IucmVzcG9uc2U/LmRhdGEsXG4gICAgICAgIHJlcXVlc3REYXRhOiBib29raW5nLFxuICAgICAgICB1cmw6IHRoaXMuYnVpbGRVUkwoJy9ib29raW5ncycpXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgSFRNTCAoZXJyb3IgcGFnZSlcbiAgICAgIGNvbnN0IHJlc3BvbnNlRGF0YSA9IGVycm9yLnJlc3BvbnNlPy5kYXRhO1xuICAgICAgaWYgKHR5cGVvZiByZXNwb25zZURhdGEgPT09ICdzdHJpbmcnICYmIFxuICAgICAgICAgIChyZXNwb25zZURhdGEuaW5jbHVkZXMoJzwhZG9jdHlwZSBodG1sPicpIHx8IFxuICAgICAgICAgICByZXNwb25zZURhdGEuaW5jbHVkZXMoJzxodG1sJykgfHwgXG4gICAgICAgICAgIHJlc3BvbnNlRGF0YS5pbmNsdWRlcygnPCFET0NUWVBFJykpKSB7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gcmVzcG9uc2VEYXRhLm1hdGNoKC88dGl0bGU+KC4qPyk8XFwvdGl0bGU+L2kpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlTWF0Y2ggPyB0aXRsZU1hdGNoWzFdIDogJ1Vua25vd24gSFRNTCBwYWdlJztcbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ/CfmqggTG9iYnlQTVMgY3JlYXRlQm9va2luZyByZXR1cm5lZCBIVE1MIHBhZ2UgaW5zdGVhZCBvZiBKU09OOicpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCfwn5qoIFBhZ2UgdGl0bGU6JywgdGl0bGUpO1xuICAgICAgICBjb25zb2xlLmVycm9yKCfwn5qoIEhUTUwgcHJldmlldzonLCByZXNwb25zZURhdGEuc3Vic3RyaW5nKDAsIDMwMCkpO1xuICAgICAgICBcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBMb2JieVBNUyBjcmVhdGVCb29raW5nIEFQSSByZXR1cm5lZCBIVE1MIHBhZ2UgXCIke3RpdGxlfVwiIGluc3RlYWQgb2YgSlNPTiAtIHBvc3NpYmxlIElQIGF1dGhvcml6YXRpb24gb3IgQVBJIHRva2VuIGlzc3VlYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmF0ZXMgaW5mb3JtYXRpb25cbiAgICovXG4gIGFzeW5jIGdldFJhdGVzKHBhcmFtcz86IHtcbiAgICByb29tX3R5cGVfaWQ/OiBzdHJpbmc7XG4gICAgYXJyaXZhbF9kYXRlPzogc3RyaW5nO1xuICAgIGRlcGFydHVyZV9kYXRlPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChcbiAgICAgICAgdGhpcy5idWlsZFVSTCgnL3JhdGVzJywgcGFyYW1zKSxcbiAgICAgICAgeyB0aW1lb3V0OiAxMDAwMCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEgfHwgW107XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvYmJ5UE1TIGdldFJhdGVzIGVycm9yOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcHJvZHVjdHMvc2VydmljZXNcbiAgICovXG4gIGFzeW5jIGdldFByb2R1Y3RzKCk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoXG4gICAgICAgIHRoaXMuYnVpbGRVUkwoJy9wcm9kdWN0cycpLFxuICAgICAgICB7IHRpbWVvdXQ6IDEwMDAwIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YSB8fCBbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignTG9iYnlQTVMgZ2V0UHJvZHVjdHMgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjbGllbnRzIGluZm9ybWF0aW9uXG4gICAqL1xuICBhc3luYyBnZXRDbGllbnRzKHBhcmFtcz86IHtcbiAgICBlbWFpbD86IHN0cmluZztcbiAgICBwaG9uZT86IHN0cmluZztcbiAgfSk6IFByb21pc2U8YW55W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoXG4gICAgICAgIHRoaXMuYnVpbGRVUkwoJy9jbGllbnRzJywgcGFyYW1zKSxcbiAgICAgICAgeyB0aW1lb3V0OiAxMDAwMCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEgfHwgW107XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xvYmJ5UE1TIGdldENsaWVudHMgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCByb29tIGF2YWlsYWJpbGl0eSwgcmF0ZXMgYW5kIHJlc3RyaWN0aW9ucyBmb3Igc3BlY2lmaWMgZGF0ZXNcbiAgICogQWNjb3JkaW5nIHRvIExvYmJ5UE1TIEFQSSBkb2N1bWVudGF0aW9uOiBHRVQgL2FwaS92MS9hdmFpbGFibGUtcm9vbXNcbiAgICovXG4gIGFzeW5jIGdldEF2YWlsYWJsZVJvb21zKHBhcmFtczoge1xuICAgIHN0YXJ0X2RhdGU6IHN0cmluZztcbiAgICBlbmRfZGF0ZTogc3RyaW5nO1xuICAgIGNhdGVnb3J5X2lkPzogc3RyaW5nO1xuICB9KTogUHJvbWlzZTxhbnlbXT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBDb252ZXJ0IElTTyBkYXRlcyB0byBZWVlZLW1tLWRkIGZvcm1hdCAocmVxdWlyZWQgYnkgQVBJKVxuICAgICAgY29uc3Qgc3RhcnREYXRlID0gcGFyYW1zLnN0YXJ0X2RhdGUuaW5jbHVkZXMoJ1QnKSA/IHBhcmFtcy5zdGFydF9kYXRlLnNwbGl0KCdUJylbMF0gOiBwYXJhbXMuc3RhcnRfZGF0ZTtcbiAgICAgIGNvbnN0IGVuZERhdGUgPSBwYXJhbXMuZW5kX2RhdGUuaW5jbHVkZXMoJ1QnKSA/IHBhcmFtcy5lbmRfZGF0ZS5zcGxpdCgnVCcpWzBdIDogcGFyYW1zLmVuZF9kYXRlO1xuICAgICAgXG4gICAgICAvLyBCdWlsZCBwYXJhbWV0ZXJzIGFjY29yZGluZyB0byBBUEkgZG9jdW1lbnRhdGlvblxuICAgICAgY29uc3QgYXBpUGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgICBzdGFydF9kYXRlOiBzdGFydERhdGUsXG4gICAgICAgIGVuZF9kYXRlOiBlbmREYXRlXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBPbmx5IGFkZCBjYXRlZ29yeV9pZCBpZiBwcm92aWRlZFxuICAgICAgaWYgKHBhcmFtcy5jYXRlZ29yeV9pZCkge1xuICAgICAgICBhcGlQYXJhbXMuY2F0ZWdvcnlfaWQgPSBwYXJhbXMuY2F0ZWdvcnlfaWQ7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGZpbmFsVXJsID0gdGhpcy5idWlsZFVSTCgnL2F2YWlsYWJsZS1yb29tcycsIGFwaVBhcmFtcyk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNID09PT09IExPQkJZIFBNUyBBVkFJTEFCTEUgUk9PTVMgQVBJID09PT09Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+UjSBFbmRwb2ludDogL2F2YWlsYWJsZS1yb29tcyAoQ09SUkVDVCBwZXIgZG9jdW1lbnRhdGlvbiknKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIFN0YXJ0IGRhdGU6Jywgc3RhcnREYXRlKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SNIEVuZCBkYXRlOicsIGVuZERhdGUpO1xuICAgICAgY29uc29sZS5sb2coJ/CflI0gQ2F0ZWdvcnkgSUQ6JywgcGFyYW1zLmNhdGVnb3J5X2lkIHx8ICdBbGwgY2F0ZWdvcmllcycpO1xuICAgICAgY29uc29sZS5sb2coJ/CflI0gRmluYWwgVVJMOicsIGZpbmFsVXJsKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoZmluYWxVcmwsIHsgXG4gICAgICAgICAgICAgIHRpbWVvdXQ6IDE1MDAwLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6ICdTdXJmQ2FtcFNhbnRhVGVyZXNhLzEuMCdcbiAgICAgIH1cbiAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/Cfk6UgPT09PT0gQVBJIFJFU1BPTlNFIEFOQUxZU0lTID09PT09Jyk7XG4gICAgICBjb25zb2xlLmxvZygn8J+TpSBTdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OlIENvbnRlbnQtVHlwZTonLCByZXNwb25zZS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSk7XG4gICAgICBjb25zb2xlLmxvZygn8J+TpSBSZXNwb25zZSBUeXBlOicsIHR5cGVvZiByZXNwb25zZURhdGEpO1xuICAgICAgY29uc29sZS5sb2coJ/Cfk6UgSGFzIGRhdGEgcHJvcGVydHk6JywgISEocmVzcG9uc2VEYXRhICYmICdkYXRhJyBpbiByZXNwb25zZURhdGEpKTtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5OlIERhdGEgbGVuZ3RoOicsIHJlc3BvbnNlRGF0YT8uZGF0YT8ubGVuZ3RoIHx8IDApO1xuICAgICAgXG4gICAgICAvLyBWYWxpZGF0ZSByZXNwb25zZSBzdHJ1Y3R1cmVcbiAgICAgIGlmICghcmVzcG9uc2VEYXRhIHx8IHR5cGVvZiByZXNwb25zZURhdGEgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXNwb25zZSBmb3JtYXQgZnJvbSBMb2JieVBNUyBBUEknKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgcmVzcG9uc2UgaXMgSFRNTCAoZXJyb3IgcGFnZSlcbiAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2VEYXRhID09PSAnc3RyaW5nJyAmJiBcbiAgICAgICAgICAocmVzcG9uc2VEYXRhLmluY2x1ZGVzKCc8IWRvY3R5cGUgaHRtbD4nKSB8fCBcbiAgICAgICAgICAgcmVzcG9uc2VEYXRhLmluY2x1ZGVzKCc8aHRtbCcpIHx8IFxuICAgICAgICAgICByZXNwb25zZURhdGEuaW5jbHVkZXMoJzwhRE9DVFlQRScpKSkge1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCB0aXRsZSBmcm9tIEhUTUwgZm9yIG1vcmUgc3BlY2lmaWMgZXJyb3JcbiAgICAgICAgY29uc3QgdGl0bGVNYXRjaCA9IHJlc3BvbnNlRGF0YS5tYXRjaCgvPHRpdGxlPiguKj8pPFxcL3RpdGxlPi9pKTtcbiAgICAgICAgY29uc3QgdGl0bGUgPSB0aXRsZU1hdGNoID8gdGl0bGVNYXRjaFsxXSA6ICdVbmtub3duIEhUTUwgcGFnZSc7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmVycm9yKCfwn5qoIExvYmJ5UE1TIHJldHVybmVkIEhUTUwgcGFnZSBpbnN0ZWFkIG9mIEpTT046Jyk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ/CfmqggUGFnZSB0aXRsZTonLCB0aXRsZSk7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ/CfmqggSFRNTCBwcmV2aWV3OicsIHJlc3BvbnNlRGF0YS5zdWJzdHJpbmcoMCwgMzAwKSk7XG4gICAgICAgIFxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExvYmJ5UE1TIEFQSSByZXR1cm5lZCBIVE1MIHBhZ2UgXCIke3RpdGxlfVwiIGluc3RlYWQgb2YgSlNPTiAtIHBvc3NpYmxlIElQIGF1dGhvcml6YXRpb24gb3IgQVBJIHRva2VuIGlzc3VlYCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgVmFsaWQgSlNPTiByZXNwb25zZSByZWNlaXZlZCBmcm9tIExvYmJ5UE1TJyk7XG4gICAgICBcbiAgICAgIC8vIExvZyByZXNwb25zZSBzdHJ1Y3R1cmUgZm9yIGRlYnVnZ2luZ1xuICAgICAgY29uc3QgZGF0YUFycmF5ID0gcmVzcG9uc2VEYXRhLmRhdGEgfHwgW107XG4gICAgICBjb25zb2xlLmxvZygn8J+TiiBSZXNwb25zZSBzdW1tYXJ5OicpO1xuICAgICAgY29uc29sZS5sb2coJyAgIPCfk4UgRGF5cyByZXR1cm5lZDonLCBkYXRhQXJyYXkubGVuZ3RoKTtcbiAgICAgIFxuICAgICAgaWYgKGRhdGFBcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCcgICDwn5OFIEZpcnN0IGRheTonLCBkYXRhQXJyYXlbMF0uZGF0ZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCcgICDwn4+gIENhdGVnb3JpZXMgaW4gZmlyc3QgZGF5OicsIGRhdGFBcnJheVswXS5jYXRlZ29yaWVzPy5sZW5ndGggfHwgMCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoZGF0YUFycmF5WzBdLmNhdGVnb3JpZXMgJiYgZGF0YUFycmF5WzBdLmNhdGVnb3JpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGZpcnN0Q2F0ZWdvcnkgPSBkYXRhQXJyYXlbMF0uY2F0ZWdvcmllc1swXTtcbiAgICAgICAgICBjb25zb2xlLmxvZygnICAg8J+PoCBGaXJzdCBjYXRlZ29yeSBleGFtcGxlOicsIHtcbiAgICAgICAgICAgIGlkOiBmaXJzdENhdGVnb3J5LmNhdGVnb3J5X2lkLFxuICAgICAgICAgICAgbmFtZTogZmlyc3RDYXRlZ29yeS5uYW1lLFxuICAgICAgICAgICAgYXZhaWxhYmxlX3Jvb21zOiBmaXJzdENhdGVnb3J5LmF2YWlsYWJsZV9yb29tcyxcbiAgICAgICAgICAgIHByaWNlczogZmlyc3RDYXRlZ29yeS5wcmljZXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gZGF0YUFycmF5O1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gZXJyb3IucmVzcG9uc2U/LmRhdGE7XG4gICAgICBjb25zdCBpc0h0bWxSZXNwb25zZSA9IHR5cGVvZiByZXNwb25zZURhdGEgPT09ICdzdHJpbmcnICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVzcG9uc2VEYXRhLmluY2x1ZGVzKCc8IWRvY3R5cGUgaHRtbD4nKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlRGF0YS5pbmNsdWRlcygnPGh0bWwnKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlRGF0YS5pbmNsdWRlcygnPCFET0NUWVBFJykpO1xuICAgICAgXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgTE9CQlkgUE1TIEFWQUlMQUJMRSBST09NUyBFUlJPUjonLCB7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIHN0YXR1czogZXJyb3IucmVzcG9uc2U/LnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogZXJyb3IucmVzcG9uc2U/LnN0YXR1c1RleHQsXG4gICAgICAgIHJlc3BvbnNlVHlwZTogdHlwZW9mIHJlc3BvbnNlRGF0YSxcbiAgICAgICAgaXNIdG1sUmVzcG9uc2U6IGlzSHRtbFJlc3BvbnNlLFxuICAgICAgICByZXNwb25zZVByZXZpZXc6IHR5cGVvZiByZXNwb25zZURhdGEgPT09ICdzdHJpbmcnIFxuICAgICAgICAgID8gcmVzcG9uc2VEYXRhLnN1YnN0cmluZygwLCAzMDApIFxuICAgICAgICAgIDogcmVzcG9uc2VEYXRhLFxuICAgICAgICByZXF1ZXN0VXJsOiB0aGlzLmJ1aWxkVVJMKCcvYXZhaWxhYmxlLXJvb21zJywge1xuICAgICAgICAgIHN0YXJ0X2RhdGU6IHBhcmFtcy5zdGFydF9kYXRlLmluY2x1ZGVzKCdUJykgPyBwYXJhbXMuc3RhcnRfZGF0ZS5zcGxpdCgnVCcpWzBdIDogcGFyYW1zLnN0YXJ0X2RhdGUsXG4gICAgICAgICAgZW5kX2RhdGU6IHBhcmFtcy5lbmRfZGF0ZS5pbmNsdWRlcygnVCcpID8gcGFyYW1zLmVuZF9kYXRlLnNwbGl0KCdUJylbMF0gOiBwYXJhbXMuZW5kX2RhdGUsXG4gICAgICAgICAgLi4uKHBhcmFtcy5jYXRlZ29yeV9pZCAmJiB7IGNhdGVnb3J5X2lkOiBwYXJhbXMuY2F0ZWdvcnlfaWQgfSlcbiAgICAgICAgfSksXG4gICAgICAgIGFwaVRva2VuOiB0aGlzLmFwaVRva2VuLnNsaWNlKC04KVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIEVuaGFuY2VkIGVycm9yIG1lc3NhZ2UgYmFzZWQgb24gcmVzcG9uc2UgdHlwZVxuICAgICAgbGV0IGVycm9yTWVzc2FnZSA9IGBMb2JieVBNUyBhdmFpbGFibGUgcm9vbXMgQVBJIGZhaWxlZDogJHtlcnJvci5tZXNzYWdlfWA7XG4gICAgICBcbiAgICAgIGlmIChpc0h0bWxSZXNwb25zZSkge1xuICAgICAgICBjb25zdCB0aXRsZU1hdGNoID0gcmVzcG9uc2VEYXRhLm1hdGNoKC88dGl0bGU+KC4qPyk8XFwvdGl0bGU+L2kpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IHRpdGxlTWF0Y2ggPyB0aXRsZU1hdGNoWzFdIDogJ1Vua25vd24gcGFnZSc7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGBMb2JieVBNUyBBUEkgcmV0dXJuZWQgSFRNTCBwYWdlIFwiJHt0aXRsZX1cIiBpbnN0ZWFkIG9mIEpTT04gLSBjaGVjayBJUCBhdXRob3JpemF0aW9uIGFuZCBBUEkgdG9rZW5gO1xuICAgICAgfVxuICAgICAgXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgaWYgQVBJIGlzIGNvbmZpZ3VyZWQgYW5kIHdvcmtpbmdcbiAgICovXG4gIGlzQ29uZmlndXJlZCgpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgdmFsaWQgQVBJIHRva2VuIHRoYXQncyBub3QgYSBwbGFjZWhvbGRlclxuICAgIGNvbnN0IGhhc1ZhbGlkVG9rZW4gPSAhISh0aGlzLmFwaVRva2VuICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwaVRva2VuICE9PSAneW91cl9hcGlfdG9rZW5faGVyZScgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcGlUb2tlbi5sZW5ndGggPiAyMCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAhdGhpcy5hcGlUb2tlbi5pbmNsdWRlcygncGxhY2Vob2xkZXInKSk7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhIHZhbGlkIGJhc2UgVVJMXG4gICAgY29uc3QgaGFzVmFsaWRVUkwgPSAhISh0aGlzLmJhc2VVUkwgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYmFzZVVSTCAhPT0gJ2h0dHBzOi8veW91ci1hcGktdXJsLmNvbScgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMuYmFzZVVSTC5pbmNsdWRlcygncGxhY2Vob2xkZXInKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJhc2VVUkwuaW5jbHVkZXMoJ2xvYmJ5cG1zLmNvbScpKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UpyBMb2JieVBNUyBDb25maWd1cmF0aW9uIENoZWNrOicsIHtcbiAgICAgIGhhc1ZhbGlkVG9rZW4sXG4gICAgICBoYXNWYWxpZFVSTCxcbiAgICAgIHRva2VuTGVuZ3RoOiB0aGlzLmFwaVRva2VuPy5sZW5ndGggfHwgMCxcbiAgICAgIGJhc2VVUkw6IHRoaXMuYmFzZVVSTCxcbiAgICAgIGlzQ29uZmlndXJlZDogaGFzVmFsaWRUb2tlbiAmJiBoYXNWYWxpZFVSTFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBoYXNWYWxpZFRva2VuICYmIGhhc1ZhbGlkVVJMO1xuICB9XG5cbiAgLyoqXG4gICAqIFRlc3QgQVBJIGNvbm5lY3Rpdml0eVxuICAgKi9cbiAgYXN5bmMgdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFVzZSB0aGUgY29ycmVjdCBlbmRwb2ludCBmb3IgdGVzdGluZ1xuICAgICAgYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVSb29tcyh7XG4gICAgICAgIHN0YXJ0X2RhdGU6ICcyMDI1LTAxLTAxJyxcbiAgICAgICAgZW5kX2RhdGU6ICcyMDI1LTAxLTAyJ1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG4vLyBFeHBvcnQgYSBkZWZhdWx0IGluc3RhbmNlXG5leHBvcnQgY29uc3QgbG9iYnlQTVNDbGllbnQgPSBuZXcgTG9iYnlQTVNDbGllbnQoKTsgIl0sIm5hbWVzIjpbImF4aW9zIiwiTE9CQllQTVNfQkFTRV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiTE9CQllQTVNfQVBJX1VSTCIsIkxPQkJZUE1TX0FQSV9UT0tFTiIsIkxPQkJZUE1TX0FQSV9LRVkiLCJMb2JieVBNU0NsaWVudCIsImNvbnN0cnVjdG9yIiwiYmFzZVVSTCIsImFwaVRva2VuIiwiYnVpbGRVUkwiLCJlbmRwb2ludCIsImFkZGl0aW9uYWxQYXJhbXMiLCJjbGVhbkVuZHBvaW50Iiwic3RhcnRzV2l0aCIsInNsaWNlIiwiYmFzZVVybCIsImVuZHNXaXRoIiwidXJsIiwiVVJMIiwic2VhcmNoUGFyYW1zIiwic2V0IiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSIsImNvbnNvbGUiLCJsb2ciLCJvcmlnaW5hbEVuZHBvaW50IiwiZmluYWxVcmwiLCJ0b1N0cmluZyIsImdldFJvb21zIiwicGFyYW1zIiwicmVzcG9uc2UiLCJyZXNwb25zZURhdGEiLCJnZXQiLCJ0aW1lb3V0IiwiaGVhZGVycyIsImRhdGEiLCJzdGF0dXMiLCJKU09OIiwic3RyaW5naWZ5IiwibGVuZ3RoIiwiaW5jbHVkZXMiLCJzdWJzdHJpbmciLCJ0aXRsZU1hdGNoIiwibWF0Y2giLCJFcnJvciIsInJlcXVlc3RFcnJvciIsImVycm9yIiwibWVzc2FnZSIsInN0YXR1c1RleHQiLCJyZXNwb25zZVR5cGUiLCJyZXNwb25zZUxlbmd0aCIsImtleXMiLCJmYWxsYmFja1VybCIsImNhdGVnb3JpZXMiLCJyb29tcyIsImNhdGVnb3J5IiwiaW5kZXgiLCJpZCIsImNhdGVnb3J5X2lkIiwibmFtZSIsImNhcGFjaXR5IiwicXVhbnRpdHkiLCJyb29tc0NvdW50IiwiQXJyYXkiLCJpc0FycmF5Iiwicm9vbSIsInJvb21fdHlwZV9pZCIsInJvb21fdHlwZV9uYW1lIiwiYXZhaWxhYmxlX3Jvb21zIiwicHJpY2VfcGVyX25pZ2h0IiwidW5kZWZpbmVkIiwicmF0ZSIsInB1c2giLCJzdGFjayIsImNvbmZpZyIsInRva2VuTGFzdENoYXJzIiwicGFyYW1zVXNlZCIsInNwZWNpZmljRXJyb3IiLCJjb2RlIiwiZW5oYW5jZWRFcnJvciIsIm9yaWdpbmFsRXJyb3IiLCJzdGF0dXNDb2RlIiwiYXBpVXJsIiwiZ2V0Qm9va2luZ3MiLCJjcmVhdGVCb29raW5nIiwiYm9va2luZyIsInBvc3QiLCJyZXF1ZXN0RGF0YSIsInRpdGxlIiwiZ2V0UmF0ZXMiLCJnZXRQcm9kdWN0cyIsImdldENsaWVudHMiLCJnZXRBdmFpbGFibGVSb29tcyIsInN0YXJ0RGF0ZSIsInN0YXJ0X2RhdGUiLCJzcGxpdCIsImVuZERhdGUiLCJlbmRfZGF0ZSIsImFwaVBhcmFtcyIsImRhdGFBcnJheSIsImRhdGUiLCJmaXJzdENhdGVnb3J5IiwicHJpY2VzIiwiaXNIdG1sUmVzcG9uc2UiLCJyZXNwb25zZVByZXZpZXciLCJyZXF1ZXN0VXJsIiwiZXJyb3JNZXNzYWdlIiwiaXNDb25maWd1cmVkIiwiaGFzVmFsaWRUb2tlbiIsImhhc1ZhbGlkVVJMIiwidG9rZW5MZW5ndGgiLCJ0ZXN0Q29ubmVjdGlvbiIsImxvYmJ5UE1TQ2xpZW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/lobbypms.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/axios","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/supports-color","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cloko_%5COneDrive%5CDesktop%5CEscritorio%5Csurfcamp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();