"use strict";(()=>{var e={};e.id=223,e.ids=[223],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},3837:e=>{e.exports=require("util")},3200:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>d,originalPathname:()=>_,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>u,staticGenerationBailout:()=>l});var n={};r.r(n),r.d(n,{POST:()=>POST});var o=r(884),a=r(6132),s=r(5798),i=r(8888);async function POST(e){try{let t=await e.json(),{amount:r,currency:n="eur",bookingReference:o}=t,a="sk_test_placeholder";if(!a||a.includes("placeholder")||a.length<50)return console.log("\uD83C\uDFAF Stripe not configured properly, using demo mode"),s.Z.json({success:!0,clientSecret:`pi_demo_${Date.now()}_secret_demo`,paymentIntentId:`pi_demo_${Date.now()}`,message:"Demo payment intent created (development mode)",amount:r,currency:n,demoMode:!0});console.log("\uD83C\uDFAF Attempting to create real Stripe payment intent...");try{let e=new i.Z(a,{apiVersion:"2023-10-16"}),t=await e.paymentIntents.create({amount:Math.round(100*r),currency:n.toLowerCase(),automatic_payment_methods:{enabled:!0},metadata:{booking_reference:o,source:"surfcamp-santa-teresa"},description:`Surf Camp Booking - ${o}`});return s.Z.json({success:!0,clientSecret:t.client_secret,paymentIntentId:t.id,amount:r,currency:n,demoMode:!1})}catch(e){return console.error("Stripe error, falling back to demo mode:",e),s.Z.json({success:!0,clientSecret:`pi_demo_fallback_${Date.now()}_secret`,paymentIntentId:`pi_demo_fallback_${Date.now()}`,message:"Demo payment intent created (Stripe fallback)",amount:r,currency:n,demoMode:!0,stripeError:e instanceof Error?e.message:"Unknown Stripe error"})}}catch(e){return console.error("Payment intent creation error:",e),s.Z.json({success:!0,clientSecret:`pi_demo_error_${Date.now()}_secret`,paymentIntentId:`pi_demo_error_${Date.now()}`,message:"Demo payment intent created (error fallback)",demoMode:!0,error:e instanceof Error?e.message:"Unknown error"})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/payment/create-intent/route",pathname:"/api/payment/create-intent",filename:"route",bundlePath:"app/api/payment/create-intent/route"},resolvedPagePath:"C:\\Users\\loko_\\OneDrive\\Desktop\\Escritorio\\surfcamp\\app\\api\\payment\\create-intent\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:m,headerHooks:d,staticGenerationBailout:l}=c,_="/api/payment/create-intent/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[997,806,851],()=>__webpack_exec__(3200));module.exports=r})();